<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartShop AI - Your Shopping Assistant</title>
    <link rel="stylesheet" href="./styles/main.css">
    <link rel="stylesheet" href="./styles/dark-mode.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-brand">
            <img src="assets/logo.png" alt="SmartShop AI Logo" class="nav-logo">
            <span>SmartShop AI</span>
        </div>
        <div class="nav-links">
            <a href="index.html" class="active">Strona gÅ‚Ã³wna</a>
            <a href="pages/stores.html">Sklepy</a>
            <a href="pages/products.html">Produkty</a>
            <a href="pages/shopping-list.html">Lista zakupÃ³w</a>
            <a href="pages/smartshop-pro.html">SmartShop Pro</a>
        </div>
        <div class="nav-actions">
            <button id="theme-toggle" class="theme-toggle">
                ðŸŒ™
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">
        <section class="hero">
            <h1>Witaj w SmartShop AI</h1>
    <title>SmartShop AI - Full Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="" />
          
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <style>
        /* ============= ENHANCED THEME SYSTEM ============= */
        :root {
            /* Light Theme */
            --bg-primary: #f8fafc;
            --bg-secondary: #f1f5f9;
            --bg-card: #ffffff;
            --bg-surface: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --text-accent: #3b82f6;
            --border-color: #e2e8f0;
            --border-hover: #cbd5e1;
            --shadow-color: rgba(15, 23, 42, 0.1);
            --shadow-strong: rgba(15, 23, 42, 0.15);
            --header-bg: rgba(255, 255, 255, 0.85);
            --dropdown-bg: #ffffff;
            --dropdown-hover: #f1f5f9;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        [data-theme="dark"] {
            /* Dark Theme */
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #1e293b;
            --bg-surface: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --text-accent: #60a5fa;
            --border-color: #334155;
            --border-hover: #475569;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --shadow-strong: rgba(0, 0, 0, 0.5);
            --header-bg: rgba(30, 41, 59, 0.9);
            --dropdown-bg: #1e293b;
            --dropdown-hover: #334155;
            --accent-primary: #60a5fa;
            --accent-secondary: #a78bfa;
            --success: #34d399;
            --warning: #fbbf24;
            --error: #f87171;
        }

        /* ============= BASE STYLES ============= */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        body { 
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Enhanced Background Gradients */
        .theme-bg-primary {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
        }

        [data-theme="dark"] .theme-bg-primary {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }

        .theme-bg-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px -1px var(--shadow-color);
        }

        .theme-text-primary { color: var(--text-primary); }
        .theme-text-secondary { color: var(--text-secondary); }
        .theme-text-muted { color: var(--text-muted); }
        .theme-text-accent { color: var(--text-accent); }

        /* ============= ENHANCED GRADIENTS ============= */
        .gradient-primary { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        }
        
        [data-theme="dark"] .gradient-primary {
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
        }

        .gradient-secondary { 
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); 
        }

        [data-theme="dark"] .gradient-secondary {
            background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        }

        /* ============= ENHANCED CARDS ============= */
        .card-premium { 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(16px);
            background: var(--bg-card);
            border: 1px solid var(--border-color);
        }

        .card-premium:hover { 
            transform: translateY(-8px) scale(1.02); 
            box-shadow: 0 25px 50px -12px var(--shadow-strong);
            border-color: var(--border-hover);
        }

        [data-theme="dark"] .card-premium {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(51, 65, 85, 0.6) 100%);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .card-premium:hover {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
            background: linear-gradient(135deg, rgba(51, 65, 85, 0.9) 0%, rgba(71, 85, 105, 0.7) 100%);
        }

        /* ============= STORE COLORS (Enhanced) ============= */
        .store-lidl { 
            background: linear-gradient(135deg, #0050aa, #003d82); 
            color: white;
        }
        
        [data-theme="dark"] .store-lidl {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }

        .store-biedronka { 
            background: linear-gradient(135deg, #e31e24, #b01419); 
            color: white;
        }

        [data-theme="dark"] .store-biedronka {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .store-auchan { 
            background: linear-gradient(135deg, #ff6900, #e55100); 
            color: white;
        }

        [data-theme="dark"] .store-auchan {
            background: linear-gradient(135deg, #f97316, #ea580c);
        }

        /* ============= ANIMATIONS ============= */
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-12px) rotate(2deg); }
        }

        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite alternate;
        }

        @keyframes pulseGlow {
            from { box-shadow: 0 0 20px var(--accent-primary); }
            to { box-shadow: 0 0 30px var(--accent-secondary), 0 0 40px var(--accent-primary); }
        }

        /* ============= LOADING SPINNER ============= */
        .loading-spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ============= ENHANCED NOTIFICATIONS ============= */
        .notification { 
            transform: translateX(100%); 
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            backdrop-filter: blur(16px);
            border: 1px solid var(--border-color);
        }

        .notification.show { 
            transform: translateX(0); 
        }

        /* ============= DROPDOWN ENHANCEMENTS ============= */
        .language-selector {
            position: relative;
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--dropdown-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            box-shadow: 0 20px 25px -5px var(--shadow-color), 0 10px 10px -5px var(--shadow-color);
            backdrop-filter: blur(16px);
            z-index: 50;
            min-width: 140px;
            display: none;
            overflow: hidden;
        }

        .language-dropdown.show {
            display: block;
            animation: dropdownSlideIn 0.3s ease-out;
        }

        @keyframes dropdownSlideIn {
            from { opacity: 0; transform: translateY(-10px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .language-option {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-primary);
            font-weight: 500;
        }

        .language-option:hover {
            background: var(--dropdown-hover);
            transform: translateX(4px);
        }

        /* ============= THEME TOGGLE ENHANCEMENT ============= */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 28px;
            background: var(--border-color);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .theme-toggle::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-radius: 50%;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.3);
        }

        [data-theme="dark"] .theme-toggle {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
        }

        [data-theme="dark"] .theme-toggle::before {
            transform: translateX(32px);
            background: linear-gradient(135deg, #e5e7eb, #f3f4f6);
            box-shadow: 0 2px 8px rgba(229, 231, 235, 0.3);
        }

        /* ============= ENHANCED INPUTS ============= */
        input[type="text"],
        input[type="number"],
        select {
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.1);
            outline: none;
        }

        input[type="text"]::placeholder {
            color: var(--text-muted);
        }

        /* ============= ENHANCED BUTTONS ============= */
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px var(--shadow-color);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--dropdown-hover);
            color: var(--text-primary);
            border-color: var(--border-hover);
        }

        /* ============= ENHANCED NAVIGATION SYSTEM ============= */
        .nav-button-v2 {
            position: relative;
            overflow: hidden;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 900;
            letter-spacing: 0.05em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-button-v2:hover {
            transform: translateY(-2px);
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }

        .nav-button-v2 i {
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
            transition: all 0.3s ease;
        }

        .nav-button-v2:hover i {
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4));
        }

        .nav-button-v2.active {
            color: white !important;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
        }

        .nav-button-v2.active i {
            filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.5));
        }

        /* Revolutionary Navigation Container */
        nav {
            backdrop-filter: blur(20px) saturate(180%);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* ============= ENHANCED STATS CARDS ============= */
        .stats-icon {
            transition: all 0.3s ease;
        }

        .card-premium:hover .stats-icon {
            transform: scale(1.1) rotate(5deg);
        }

        /* ============= GLASSMORPHISM EFFECTS ============= */
        .glass-effect {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        [data-theme="dark"] .glass-effect {
            background: rgba(30, 41, 59, 0.3);
            border: 1px solid rgba(71, 85, 105, 0.3);
        }

        /* ============= ENHANCED HEADER ============= */
        .header-bg {
            background: var(--header-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
        }

        /* ============= ENHANCED SCROLLBAR ============= */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-hover);
        }

        /* ============= GLOW EFFECTS ============= */
        .glow-primary {
            box-shadow: 0 0 20px var(--accent-primary);
        }

        .glow-success {
            box-shadow: 0 0 20px var(--success);
        }

        /* ============= ENHANCED TYPOGRAPHY ============= */
        .text-gradient {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        [data-theme="dark"] .text-gradient {
            background: linear-gradient(135deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ============= PRODUCT CARD ENHANCEMENTS ============= */
        .product-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            transition: all 0.4s ease;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px -10px var(--shadow-strong);
        }

        .product-image {
            transition: all 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        /* ============= LOCATION-BASED STORE FINDER ============= 
        let nearbyStores = [];
        
        async function findNearbyStores() {
            const location = document.getElementById('locationInput').value.trim();
            if (!location) {
                showNotification('LÃ¼tfen bir konum girin', 'warning');
                return;
            }

            const resultsDiv = document.getElementById('storeResults');
            resultsDiv.innerHTML = '<div class="text-center py-8"><div class="loading-spinner mx-auto"></div><p class="mt-4 theme-text-secondary">YakÄ±ndaki marketler aranÄ±yor...</p></div>';
            resultsDiv.classList.remove('hidden');

            try {
                // Simulate API call to find nearby stores
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                nearbyStores = [
                    {
                        name: 'Lidl',
                        address: 'AtatÃ¼rk Cad. No:15, KadÄ±kÃ¶y',
                        distance: '0.8 km',
                        openUntil: '22:00',
                        type: 'supermarket',
                        promotions: 3,
                        rating: 4.5
                    },
                    {
                        name: 'BÄ°M',
                        address: 'Moda Cad. No:42, KadÄ±kÃ¶y',
                        distance: '1.2 km',
                        openUntil: '23:00',
                        type: 'discount',
                        promotions: 5,
                        rating: 4.2
                    },
                    {
                        name: 'Migros',
                        address: 'BaÄŸdat Cad. No:128, KadÄ±kÃ¶y',
                        distance: '1.5 km',
                        openUntil: '24:00',
                        type: 'supermarket',
                        promotions: 7,
                        rating: 4.6
                    }
                ];

                displayStoreResults();
                showNotification(`${nearbyStores.length} market bulundu!`, 'success');
            } catch (error) {
                resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Marketler aranÄ±rken bir hata oluÅŸtu.</p>';
                showNotification('Marketler aranÄ±rken hata oluÅŸtu', 'error');
            }
        }

        function displayStoreResults() {
            const resultsDiv = document.getElementById('storeResults');
            resultsDiv.innerHTML = nearbyStores.map(store => `
                <div class="theme-bg-card rounded-xl p-6 card-premium store-card" onclick="selectStore('${store.name}')">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h4 class="font-bold text-lg theme-text-primary">${store.name}</h4>
                            <p class="theme-text-muted text-sm">${store.type === 'supermarket' ? 'SÃ¼permarket' : 'Discount Market'}</p>
                        </div>
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">
                            ${store.distance}
                        </span>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex items-center theme-text-secondary text-sm">
                            <i class="lucide-map-pin w-4 h-4 mr-2"></i>
                            ${store.address}
                        </div>
                        <div class="flex items-center theme-text-secondary text-sm">
                            <i class="lucide-clock w-4 h-4 mr-2"></i>
                            ${store.openUntil}'e kadar aÃ§Ä±k
                        </div>
                        <div class="flex items-center theme-text-secondary text-sm">
                            <i class="lucide-star w-4 h-4 mr-2 text-yellow-500"></i>
                            ${store.rating} â€¢ ${store.promotions} aktif kampanya
                        </div>
                    </div>
                    
                    <div class="flex gap-2">
                        <button class="flex-1 py-2 gradient-primary text-white rounded-lg text-sm hover:opacity-90 transition-all">
                            <i class="lucide-navigation w-4 h-4 mr-1"></i>
                            Yol Tarifi
                        </button>
                        <button class="flex-1 py-2 bg-gray-100 theme-text-primary rounded-lg text-sm hover:bg-gray-200 transition-all">
                            <i class="lucide-tag w-4 h-4 mr-1"></i>
                            Kampanyalar
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function selectStore(storeName) {
            showNotification(`${storeName} seÃ§ildi!`, 'success');
            // Here you would typically navigate to store details or set as preferred store
        }

        // ============= PROMOTIONAL FLYERS SYSTEM ============= 
        let currentFlyers = [];
        
        function initializeFlyers() {
            currentFlyers = [
                {
                    store: 'lidl',
                    title: 'HaftalÄ±k FÄ±rsatlar',
                    validUntil: '2024-01-15',
                    discount: '50%',
                    products: [
                        { name: 'Organik Elma', price: '4.99 TL/kg', originalPrice: '9.99 TL/kg' },
                        { name: 'Tam BuÄŸday Ekmek', price: '2.50 TL', originalPrice: '4.99 TL' },
                        { name: 'SÃ¼t 1L', price: '3.99 TL', originalPrice: '6.99 TL' }
                    ],
                    image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200" fill="%230050aa"><text x="50%" y="50%" font-size="20" fill="white" text-anchor="middle" dy=".3em">LIDL</text></svg>'
                },
                {
                    store: 'bim',
                    title: 'Ã‡arÅŸamba Ã‡Ä±lgÄ±nlÄ±ÄŸÄ±',
                    validUntil: '2024-01-12',
                    discount: '40%',
                    products: [
                        { name: 'Domates', price: '2.99 TL/kg', originalPrice: '4.99 TL/kg' },
                        { name: 'Makarna', price: '1.99 TL', originalPrice: '3.99 TL' },
                        { name: 'ZeytinyaÄŸÄ± 1L', price: '24.99 TL', originalPrice: '39.99 TL' }
                    ],
                    image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200" fill="%23e31e24"><text x="50%" y="50%" font-size="20" fill="white" text-anchor="middle" dy=".3em">BÄ°M</text></svg>'
                },
                {
                    store: 'migros',
                    title: 'Haftasonu Ä°ndirimi',
                    validUntil: '2024-01-14',
                    discount: '30%',
                    products: [
                        { name: 'Tavuk But', price: '12.99 TL/kg', originalPrice: '18.99 TL/kg' },
                        { name: 'Peynir 500g', price: '19.99 TL', originalPrice: '29.99 TL' },
                        { name: 'Ã‡ay 1kg', price: '29.99 TL', originalPrice: '49.99 TL' }
                    ],
                    image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200" fill="%23ff6900"><text x="50%" y="50%" font-size="20" fill="white" text-anchor="middle" dy=".3em">MÄ°GROS</text></svg>'
                }
            ];
            
            displayFlyers('all');
        }

        function filterFlyers(storeType) {
            // Update active filter button
            document.querySelectorAll('.flyer-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            displayFlyers(storeType);
        }

        function displayFlyers(storeType) {
            const flyersGrid = document.getElementById('flyersGrid');
            const filtered = storeType === 'all' ? currentFlyers : currentFlyers.filter(f => f.store === storeType);
            
            flyersGrid.innerHTML = filtered.map(flyer => `
                <div class="theme-bg-card rounded-xl overflow-hidden card-premium flyer-card" data-store="${flyer.store}">
                    <div class="relative">
                        <img src="${flyer.image}" alt="${flyer.store} kampanya" class="w-full h-48 object-cover">
                        <div class="absolute top-4 right-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                            %${flyer.discount} Ä°NDÄ°RÄ°M
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold theme-text-primary">${flyer.title}</h3>
                            <span class="text-sm theme-text-muted">${flyer.validUntil}'e kadar</span>
                        </div>
                        
                        <div class="space-y-3 mb-6">
                            ${flyer.products.map(product => `
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all cursor-pointer" onclick="addToCartFromFlyer('${product.name}', '${product.price}')">
                                    <div>
                                        <p class="font-medium theme-text-primary">${product.name}</p>
                                        <div class="flex items-center gap-2">
                                            <span class="text-green-600 font-bold">${product.price}</span>
                                            <span class="text-gray-500 line-through text-sm">${product.originalPrice}</span>
                                        </div>
                                    </div>
                                    <button class="p-2 gradient-primary text-white rounded-lg hover:opacity-90 transition-all">
                                        <i class="lucide-plus w-4 h-4"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        
                        <button onclick="viewFullFlyer('${flyer.store}')" class="w-full py-3 border-2 border-blue-500 text-blue-500 rounded-lg hover:bg-blue-500 hover:text-white transition-all font-semibold">
                            <i class="lucide-eye w-4 h-4 mr-2"></i>
                            TÃ¼m KampanyalarÄ± GÃ¶r
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addToCartFromFlyer(productName, price) {
            // Add animation effect
            const button = event.target.closest('button');
            button.innerHTML = '<i class="lucide-check w-4 h-4"></i>';
            button.classList.add('bg-green-500');
            
            setTimeout(() => {
                button.innerHTML = '<i class="lucide-plus w-4 h-4"></i>';
                button.classList.remove('bg-green-500');
            }, 1500);
            
            showNotification(`${productName} sepete eklendi! (${price})`, 'success');
        }

        function viewFullFlyer(store) {
            showNotification(`${store.toUpperCase()} kampanyalarÄ± gÃ¶rÃ¼ntÃ¼leniyor...`, 'info');
            // Here you would typically open a modal or navigate to full flyer view
        }

        // ============= PRICE COMPARISON SYSTEM ============= 
        let priceData = {};
        
        function initializePriceData() {
            priceData = {
                'bread': [
                    { store: 'Lidl', price: 2.50, originalPrice: 3.99, discount: 37 },
                    { store: 'BÄ°M', price: 2.99, originalPrice: 3.49, discount: 14 },
                    { store: 'Migros', price: 3.25, originalPrice: 4.99, discount: 35 },
                    { store: 'Åžok', price: 2.75, originalPrice: 3.99, discount: 31 }
                ],
                'milk': [
                    { store: 'Lidl', price: 8.99, originalPrice: 10.99, discount: 18 },
                    { store: 'BÄ°M', price: 7.99, originalPrice: 9.99, discount: 20 },
                    { store: 'Migros', price: 9.49, originalPrice: 11.99, discount: 21 },
                    { store: 'Åžok', price: 8.49, originalPrice: 10.49, discount: 19 }
                ],
                'eggs': [
                    { store: 'Lidl', price: 12.99, originalPrice: 15.99, discount: 19 },
                    { store: 'BÄ°M', price: 11.99, originalPrice: 14.99, discount: 20 },
                    { store: 'Migros', price: 13.49, originalPrice: 16.99, discount: 21 },
                    { store: 'Åžok', price: 12.49, originalPrice: 15.49, discount: 19 }
                ],
                'rice': [
                    { store: 'Lidl', price: 24.99, originalPrice: 29.99, discount: 17 },
                    { store: 'BÄ°M', price: 22.99, originalPrice: 27.99, discount: 18 },
                    { store: 'Migros', price: 26.49, originalPrice: 32.99, discount: 20 },
                    { store: 'Åžok', price: 23.99, originalPrice: 28.99, discount: 17 }
                ]
            };
        }

        async function searchPrices() {
            const searchTerm = document.getElementById('priceSearchInput').value.trim().toLowerCase();
            if (!searchTerm) {
                showNotification('LÃ¼tfen bir Ã¼rÃ¼n adÄ± girin', 'warning');
                return;
            }

            const resultsDiv = document.getElementById('priceResults');
            resultsDiv.innerHTML = '<div class="text-center py-8"><div class="loading-spinner mx-auto"></div><p class="mt-4 theme-text-secondary">Fiyatlar karÅŸÄ±laÅŸtÄ±rÄ±lÄ±yor...</p></div>';
            resultsDiv.classList.remove('hidden');

            try {
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Find matching products
                const matches = Object.keys(priceData).filter(product => 
                    product.includes(searchTerm) || 
                    (searchTerm.includes('ekmek') && product === 'bread') ||
                    (searchTerm.includes('sÃ¼t') && product === 'milk') ||
                    (searchTerm.includes('yumurta') && product === 'eggs') ||
                    (searchTerm.includes('pirinÃ§') && product === 'rice')
                );

                if (matches.length > 0) {
                    displayPriceComparison(matches[0]);
                } else {
                    resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Bu Ã¼rÃ¼n iÃ§in fiyat bilgisi bulunamadÄ±.</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Fiyatlar aranÄ±rken bir hata oluÅŸtu.</p>';
                showNotification('Fiyat aramasÄ±nda hata oluÅŸtu', 'error');
            }
        }

        function comparePrices(product) {
            const resultsDiv = document.getElementById('priceResults');
            resultsDiv.classList.remove('hidden');
            displayPriceComparison(product);
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function displayPriceComparison(product) {
            const resultsDiv = document.getElementById('priceResults');
            const prices = priceData[product];
            
            if (!prices) {
                resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Bu Ã¼rÃ¼n iÃ§in fiyat bilgisi bulunamadÄ±.</p>';
                return;
            }

            // Sort by price (ascending)
            const sortedPrices = [...prices].sort((a, b) => a.price - b.price);
            const bestDeal = sortedPrices[0];

            const productNames = {
                'bread': 'Ekmek',
                'milk': 'SÃ¼t (1L)',
                'eggs': 'Yumurta (30\'lu)',
                'rice': 'PirinÃ§ (1kg)'
            };

            resultsDiv.innerHTML = `
                <div class="mb-6">
                    <h3 class="text-2xl font-bold theme-text-primary mb-2">${productNames[product]} Fiyat KarÅŸÄ±laÅŸtÄ±rmasÄ±</h3>
                    <p class="theme-text-secondary">En uygun fiyat: <span class="text-green-600 font-bold">${bestDeal.store}</span> - ${bestDeal.price} TL</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    ${sortedPrices.map((item, index) => `
                        <div class="theme-bg-card rounded-xl p-6 card-premium ${index === 0 ? 'ring-2 ring-green-500' : ''}" onclick="selectPriceOption('${item.store}', '${item.price}', '${productNames[product]}')">
                            ${index === 0 ? '<div class="absolute -top-2 -right-2 bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">EN UYGUN</div>' : ''}
                            
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 ${getStoreColor(item.store)} rounded-full flex items-center justify-center mr-4">
                                        <i class="lucide-store w-6 h-6 text-white"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg theme-text-primary">${item.store}</h4>
                                        <p class="theme-text-muted text-sm">Market</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-green-600">${item.price} TL</div>
                                    <div class="text-sm text-gray-500 line-through">${item.originalPrice} TL</div>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between mb-4">
                                <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-semibold">
                                    %${item.discount} Ä°ndirim
                                </span>
                                <span class="text-sm theme-text-muted">
                                    ${(item.originalPrice - item.price).toFixed(2)} TL tasarruf
                                </span>
                            </div>
                            
                            <button class="w-full py-2 gradient-primary text-white rounded-lg hover:opacity-90 transition-all">
                                <i class="lucide-shopping-cart w-4 h-4 mr-2"></i>
                                Sepete Ekle
                            </button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getStoreColor(store) {
            const colors = {
                'Lidl': 'bg-blue-600',
                'BÄ°M': 'bg-red-600', 
                'Migros': 'bg-orange-600',
                'Åžok': 'bg-purple-600'
            };
            return colors[store] || 'bg-gray-600';
        }

        function selectPriceOption(store, price, product) {
            showNotification(`${product} - ${store} (${price} TL) sepete eklendi!`, 'success');
        }

        // ============= ENHANCED STYLES ============= 
        const additionalStyles = `
            .flyer-filter-btn.active {
                background: var(--accent-primary);
                color: white;
                box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.4);
            }

            .store-card:hover {
                cursor: pointer;
                transform: translateY(-4px);
            }

            .flyer-card {
                transition: all 0.3s ease;
            }

            .flyer-card:hover {
                transform: translateY(-6px) scale(1.02);
            }

            .trending-product {
                transition: all 0.3s ease;
            }

            .trending-product:hover {
                transform: translateY(-4px);
                box-shadow: 0 20px 40px -12px var(--shadow-strong);
            }

            #priceResults .card-premium {
                position: relative;
            }

            .gradient-text {
                background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
        `;

        // Add additional styles to the page
        const styleSheet = document.createElement('style');
        styleSheet.textContent = additionalStyles;
        document.head.appendChild(styleSheet);

        // Add enhanced animations CSS after page load
        const enhancedCSS = `
            .nav-button-v2 {
                position: relative;
                background: rgba(255, 255, 255, 0.05) !important;
                color: white !important;
                border: 1px solid rgba(255, 255, 255, 0.1) !important;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
                backdrop-filter: blur(10px) !important;
            }
            
            .nav-button-v2:hover {
                transform: translateY(-2px) !important;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3) !important;
            }
            
            .nav-button-v2.active {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
                border-color: rgba(255, 255, 255, 0.3) !important;
                box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4) !important;
            }
            
            .nav-button-v2 span {
                color: white !important;
                font-weight: 900 !important;
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5) !important;
                letter-spacing: 0.05em !important;
            }
            
            .nav-button-v2:hover span {
                color: white !important;
                text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8) !important;
            }
            
            .nav-button-v2 i {
                color: white !important;
                filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5)) !important;
            }
            
            .nav-button-v2:hover i {
                color: white !important;
                filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.8)) !important;
            }
            
            @keyframes wiggle {
                0%, 100% { transform: rotate(0deg); }
                25% { transform: rotate(-3deg); }
                75% { transform: rotate(3deg); }
            }
            
            @keyframes float {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-6px); }
            }
            
            @keyframes glow-pulse {
                0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.3); }
                50% { box-shadow: 0 0 40px rgba(102, 126, 234, 0.6), 0 0 60px rgba(102, 126, 234, 0.4); }
            }
            
            .card-premium:hover {
                transform: translateY(-8px) scale(1.02) !important;
                box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15) !important;
            }
            
            .floating-animation {
                animation: float 3s ease-in-out infinite !important;
            }
            
            .pulse-glow {
                animation: glow-pulse 2s ease-in-out infinite !important;
            }
            
            .gradient-text {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%) !important;
                background-size: 200% 200% !important;
                animation: gradient-shift 3s ease infinite !important;
                -webkit-background-clip: text !important;
                -webkit-text-fill-color: transparent !important;
                background-clip: text !important;
            }
            
            @keyframes gradient-shift {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
        `;
        
        const newStyleSheet = document.createElement('style');
        newStyleSheet.textContent = enhancedCSS;
        document.head.appendChild(newStyleSheet);
        
        // Initialize lucide icons
        lucide.createIcons();
    </style>
</head>
<body class="theme-bg-primary min-h-screen">
    <!-- Notification Container -->
    <div id="notifications" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Header -->
    <header class="header-bg sticky top-0 z-40 border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo and Branding -->
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 gradient-primary rounded-3xl flex items-center justify-center floating-animation pulse-glow shadow-2xl overflow-hidden">
                        <img src="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=64&h=64&fit=crop&crop=center" alt="SmartShop AI Logo" class="w-full h-full object-cover rounded-3xl">
                    </div>
                    <div class="flex flex-col">
                        <h1 class="text-3xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-orange-500 bg-clip-text text-transparent">
                            SmartShop AI
                        </h1>
                        <p class="text-xs font-medium theme-text-muted tracking-wider uppercase opacity-80">
                            Powered by AI, Perfected for Savings
                        </p>
                    </div>
                </div>
                
                <!-- Revolutionary Navigation -->
                <nav class="hidden lg:flex items-center space-x-2 bg-white/5 backdrop-blur-xl rounded-2xl p-2 border border-white/10">
                    <button onclick="showSection('home')" class="nav-button-v2 active group relative px-6 py-4 rounded-xl font-bold text-sm tracking-wide transition-all duration-300" data-text="nav.dashboard">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl opacity-90 group-hover:opacity-100 transition-opacity duration-300"></div>
                        <div class="relative flex items-center space-x-2 text-white drop-shadow-lg">
                            <i data-lucide="home" class="w-5 h-5 transition-transform duration-300 group-hover:scale-110"></i>
                            <span class="font-black text-white">DASHBOARD</span>
                        </div>
                    </button>
                    
                    <button onclick="showSection('products')" class="nav-button-v2 group relative px-6 py-4 rounded-xl font-bold text-sm tracking-wide transition-all duration-300" data-text="nav.products">
                        <div class="absolute inset-0 bg-gradient-to-r from-green-500 to-teal-600 rounded-xl opacity-0 group-hover:opacity-90 transition-opacity duration-300"></div>
                        <div class="relative flex items-center space-x-2 text-white/90 group-hover:text-white drop-shadow-lg">
                            <i data-lucide="package" class="w-5 h-5 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-12"></i>
                            <span class="font-black">PRODUCTS</span>
                        </div>
                    </button>
                    
                    <button onclick="showSection('shops')" class="nav-button-v2 group relative px-6 py-4 rounded-xl font-bold text-sm tracking-wide transition-all duration-300" data-text="nav.shops">
                        <div class="absolute inset-0 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl opacity-0 group-hover:opacity-90 transition-opacity duration-300"></div>
                        <div class="relative flex items-center space-x-2 text-white/90 group-hover:text-white drop-shadow-lg">
                            <i data-lucide="store" class="w-5 h-5 transition-transform duration-300 group-hover:scale-110 group-hover:-rotate-12"></i>
                            <span class="font-black">SHOPS</span>
                        </div>
                    </button>
                    
                    <button onclick="showSection('shopping-list')" class="nav-button-v2 group relative px-6 py-4 rounded-xl font-bold text-sm tracking-wide transition-all duration-300" data-text="nav.shopping_list">
                        <div class="absolute inset-0 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl opacity-0 group-hover:opacity-90 transition-opacity duration-300"></div>
                        <div class="relative flex items-center space-x-2 text-white/90 group-hover:text-white drop-shadow-lg">
                            <i data-lucide="shopping-bag" class="w-5 h-5 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-6"></i>
                            <span class="font-black">LIST</span>
                        </div>
                    </button>
                    
                    <button onclick="showSection('analytics')" class="nav-button-v2 group relative px-6 py-4 rounded-xl font-bold text-sm tracking-wide transition-all duration-300" data-text="nav.analytics">
                        <div class="absolute inset-0 bg-gradient-to-r from-indigo-500 to-blue-600 rounded-xl opacity-0 group-hover:opacity-90 transition-opacity duration-300"></div>
                        <div class="relative flex items-center space-x-2 text-white/90 group-hover:text-white drop-shadow-lg">
                        <div class="absolute inset-0 bg-gradient-to-r from-indigo-500 to-blue-600 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                        <div class="relative flex items-center space-x-2">
                            <i data-lucide="trending-up" class="w-5 h-5 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-12"></i>
                            <span>ANALYTICS</span>
                        </div>
                    </button>
                </nav>
                
                <div class="flex items-center space-x-3">
                    <!-- Dark Mode Toggle -->
                    <div class="flex items-center space-x-2">
                        <i data-lucide="sun" class="w-4 h-4 theme-text-muted"></i>
                        <div class="theme-toggle" onclick="toggleTheme()" title="KaranlÄ±k/AydÄ±nlÄ±k Mod"></div>
                        <i data-lucide="moon" class="w-4 h-4 theme-text-muted"></i>
                    </div>
                    
                    <!-- Language Selector -->
                    <div class="language-selector">
                        <button id="languageBtn" onclick="toggleLanguageDropdown()" class="btn-secondary flex items-center space-x-2 p-2 rounded-xl transition-all">
                            <span id="currentFlag">ðŸ‡¹ðŸ‡·</span>
                            <span id="currentLang" class="text-sm font-medium">TR</span>
                            <i data-lucide="chevron-down" class="w-4 h-4"></i>
                        </button>
                        <div id="languageDropdown" class="language-dropdown">
                            <div class="language-option" onclick="changeLanguage('tr')">
                                <span>ðŸ‡¹ðŸ‡·</span>
                                <span>TÃ¼rkÃ§e</span>
                            </div>
                            <div class="language-option" onclick="changeLanguage('pl')">
                                <span>ðŸ‡µðŸ‡±</span>
                                <span>Polski</span>
                            </div>
                            <div class="language-option" onclick="changeLanguage('en')">
                                <span>ðŸ‡¬ðŸ‡§</span>
                                <span>English</span>
                            </div>
                        </div>
                    </div>
                    
                    <button id="refreshDataBtn" onclick="refreshAllData()" class="btn-secondary p-2 rounded-xl transition-all">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                    </button>
                    <div class="text-sm theme-text-muted">
                        <span data-text="status">Status</span>: <span id="apiStatus" class="font-medium text-green-500" data-text="status.online">Online</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Home Section -->
        <div id="home-section" class="section">
            <!-- Enhanced Hero Section -->
            <section class="relative min-h-[70vh] flex items-center theme-bg-primary overflow-hidden mb-16 rounded-3xl">
                <!-- Animated Background -->
                <div class="absolute inset-0 opacity-10">
                    <div class="floating-animation absolute top-10 left-10 w-20 h-20 bg-blue-500 rounded-full"></div>
                    <div class="floating-animation absolute top-32 right-20 w-16 h-16 bg-purple-500 rounded-full" style="animation-delay: -2s;"></div>
                    <div class="floating-animation absolute bottom-20 left-1/4 w-12 h-12 bg-green-500 rounded-full" style="animation-delay: -4s;"></div>
                </div>

                <div class="container mx-auto px-6 z-10">
                    <div class="text-center max-w-4xl mx-auto">
                        <div class="floating-animation mb-8">
                            <div class="w-32 h-32 mx-auto gradient-primary rounded-full flex items-center justify-center pulse-glow">
                                <i class="lucide-shopping-cart w-16 h-16 text-white"></i>
                            </div>
                        </div>
                        
                        <h1 class="text-6xl font-bold mb-6 theme-text-primary">
                            SmartShop <span class="gradient-text">AI</span>
                        </h1>
                        <p class="text-xl theme-text-secondary mb-8 leading-relaxed" data-text="hero.description">
                            AI-powered shopping optimization with location-based store finder and promotional flyers
                        </p>

                        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                            <button onclick="startOptimization()" class="px-8 py-4 gradient-primary text-white rounded-xl font-semibold text-lg hover:shadow-2xl transition-all transform hover:scale-105 flex items-center">
                                <i class="lucide-zap w-6 h-6 mr-2"></i>
                                <span data-text="hero.start_optimization">Optimizasyonu BaÅŸlat</span>
                            </button>
                            <button onclick="showDemo()" class="px-8 py-4 bg-white/10 backdrop-blur-sm border border-white/20 text-white rounded-xl font-semibold text-lg hover:bg-white/20 transition-all">
                                <i class="lucide-play w-6 h-6 mr-2"></i>
                                <span data-text="hero.watch_demo">Demo Ä°zle</span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Welcome section -->
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold theme-text-primary mb-4" data-text="welcome_message">
                    HoÅŸ geldiniz! AI destekli alÄ±ÅŸveriÅŸ optimizasyonu ile tasarruf edin.
                </h2>
                <p class="theme-text-muted" data-text="welcome_description">
                    AkÄ±llÄ± algoritmalarÄ±n size Ã¶nerdiÄŸi en uygun Ã¼rÃ¼nleri keÅŸfedin
                </p>
            </div>

            <!-- Search Bar -->
            <div class="mb-8">
                <div class="max-w-2xl mx-auto">
                    <div class="flex gap-4">
                        <div class="flex-1 relative">
                            <i data-lucide="search" class="absolute left-4 top-1/2 transform -translate-y-1/2 theme-text-muted w-5 h-5"></i>
                            <input 
                                type="text" 
                                data-placeholder="search.placeholder"
                                class="w-full pl-12 pr-4 py-3 rounded-xl outline-none theme-text-primary"
                                id="globalSearch"
                            >
                        </div>
                        <button onclick="searchProducts()" class="btn-primary px-6 py-3 rounded-xl font-semibold">
                            <i data-lucide="search" class="w-5 h-5"></i>
                        </button>
                        <button onclick="triggerScraping()" class="gradient-secondary text-white px-6 py-3 rounded-xl font-semibold transition-all hover:scale-105">
                            <i data-lucide="refresh-ccw" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Location-based Store Finder -->
            <div class="max-w-2xl mx-auto mb-12">
                <div class="theme-bg-card rounded-2xl p-8 card-premium">
                    <h3 class="text-2xl font-bold theme-text-primary mb-4 flex items-center justify-center">
                        <i class="lucide-map-pin w-6 h-6 mr-2 theme-text-accent"></i>
                        <span data-text="location.title">YakÄ±ndaki Marketleri KeÅŸfet</span>
                    </h3>
                    <div class="flex flex-col md:flex-row gap-4 mb-6">
                        <input type="text" id="locationInput" 
                               data-placeholder="location.placeholder"
                               placeholder="Konum girin (Ã¶rn: KadÄ±kÃ¶y, Ä°stanbul)" 
                               class="flex-1 px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 theme-bg-card theme-text-primary">
                        <button onclick="getCurrentLocation()" 
                                class="px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all transform hover:scale-105 flex items-center">
                            <i class="lucide-crosshair w-5 h-5 mr-2"></i>
                            <span data-text="location.current">Konumum</span>
                        </button>
                        <button onclick="findNearbyStores()" 
                                class="px-6 py-3 gradient-primary text-white rounded-lg hover:opacity-90 transition-all transform hover:scale-105 flex items-center">
                            <i class="lucide-search w-5 h-5 mr-2"></i>
                            <span data-text="location.find_stores">Market Bul</span>
                        </button>
                    </div>
                    
                    <!-- Interactive Map -->
                    <div class="mb-6">
                        <div id="map" style="height: 300px; width: 100%;" class="rounded-lg overflow-hidden border border-gray-300"></div>
                    </div>
                    
                    <div id="storeResults" class="mt-6 hidden">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- Store results will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Promotional Flyers Section -->
            <section class="py-12 mb-12">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold theme-text-primary mb-4 flex items-center justify-center">
                        <i class="lucide-newspaper w-8 h-8 mr-3 theme-text-accent"></i>
                        <span data-text="flyers.title">Market AktÃ¼elleri ve Kampanyalar</span>
                    </h2>
                    <p class="text-xl theme-text-secondary" data-text="flyers.description">
                        HaftalÄ±k kampanyalarÄ± tek yerden takip edin, tek tÄ±kla sepete ekleyin
                    </p>
                </div>

                <!-- Store Filter Tabs -->
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <button onclick="filterFlyers('all')" class="flyer-filter-btn active px-6 py-3 rounded-xl font-semibold transition-all" data-text="flyers.all">
                        TÃ¼mÃ¼
                    </button>
                    <button onclick="filterFlyers('lidl')" class="flyer-filter-btn px-6 py-3 rounded-xl font-semibold transition-all store-lidl">
                        Lidl
                    </button>
                    <button onclick="filterFlyers('bim')" class="flyer-filter-btn px-6 py-3 rounded-xl font-semibold transition-all store-biedronka">
                        BÄ°M
                    </button>
                    <button onclick="filterFlyers('migros')" class="flyer-filter-btn px-6 py-3 rounded-xl font-semibold transition-all store-auchan">
                        Migros
                    </button>
                </div>

                <!-- Flyers Grid -->
                <div id="flyersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                    <!-- Flyers will be populated here -->
                </div>
            </section>

            <!-- Price Comparison Section -->
            <section class="py-12 mb-12">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold theme-text-primary mb-4 flex items-center justify-center">
                        <i class="lucide-trending-down w-8 h-8 mr-3 theme-text-accent"></i>
                        <span data-text="price.title">AkÄ±llÄ± Fiyat KarÅŸÄ±laÅŸtÄ±rma</span>
                    </h2>
                    <p class="text-xl theme-text-secondary" data-text="price.description">
                        AI destekli fiyat analizi ile en uygun fÄ±rsatlarÄ± yakalayÄ±n
                    </p>
                </div>

                <!-- Price Search -->
                <div class="max-w-4xl mx-auto mb-8">
                    <div class="theme-bg-card rounded-2xl p-8 card-premium">
                        <div class="flex flex-col md:flex-row gap-4 mb-6">
                            <input type="text" id="priceSearchInput" 
                                   data-placeholder="price.search_placeholder"
                                   placeholder="ÃœrÃ¼n adÄ± veya barkod numarasÄ± girin..." 
                                   class="flex-1 px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 theme-bg-card theme-text-primary">
                            <button onclick="searchPrices()" 
                                    class="px-6 py-3 gradient-primary text-white rounded-lg hover:opacity-90 transition-all transform hover:scale-105 flex items-center">
                                <i class="lucide-search w-5 h-5 mr-2"></i>
                                <span data-text="price.search">Fiyat Ara</span>
                            </button>
                        </div>
                        
                        <!-- Price Results -->
                        <div id="priceResults" class="hidden">
                            <!-- Price comparison results will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Trending Products -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="theme-bg-card rounded-xl p-6 card-premium trending-product" data-product="bread">
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-4 bg-yellow-100 rounded-full flex items-center justify-center overflow-hidden">
                                <img src="https://images.unsplash.com/photo-1509440159596-0249088772ff?w=64&h=64&fit=crop&crop=center" alt="Bread" class="w-full h-full object-cover rounded-full">
                            </div>
                            <h3 class="font-bold theme-text-primary mb-2" data-text="products.bread">Ekmek</h3>
                            <p class="theme-text-muted text-sm mb-4" data-text="products.compare_prices">En uygun fiyatlarÄ± karÅŸÄ±laÅŸtÄ±r</p>
                            <button onclick="comparePrices('bread')" class="w-full py-2 gradient-primary text-white rounded-lg text-sm hover:opacity-90 transition-all" data-text="products.compare">
                                Fiyat KarÅŸÄ±laÅŸtÄ±r
                            </button>
                        </div>
                    </div>
                    
                    <div class="theme-bg-card rounded-xl p-6 card-premium trending-product" data-product="milk">
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center overflow-hidden">
                                <img src="https://images.unsplash.com/photo-1563636619-e9143da7973b?w=64&h=64&fit=crop&crop=center" alt="Milk" class="w-full h-full object-cover rounded-full">
                            </div>
                            <h3 class="font-bold theme-text-primary mb-2" data-text="products.milk">SÃ¼t</h3>
                            <p class="theme-text-muted text-sm mb-4" data-text="products.compare_prices">En uygun fiyatlarÄ± karÅŸÄ±laÅŸtÄ±r</p>
                            <button onclick="comparePrices('milk')" class="w-full py-2 gradient-primary text-white rounded-lg text-sm hover:opacity-90 transition-all" data-text="products.compare">
                                Fiyat KarÅŸÄ±laÅŸtÄ±r
                            </button>
                        </div>
                    </div>
                    
                    <div class="theme-bg-card rounded-xl p-6 card-premium trending-product" data-product="eggs">
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-4 bg-orange-100 rounded-full flex items-center justify-center overflow-hidden">
                                <img src="https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?w=64&h=64&fit=crop&crop=center" alt="Eggs" class="w-full h-full object-cover rounded-full">
                            </div>
                            <h3 class="font-bold theme-text-primary mb-2" data-text="products.eggs">Yumurta</h3>
                            <p class="theme-text-muted text-sm mb-4" data-text="products.compare_prices">En uygun fiyatlarÄ± karÅŸÄ±laÅŸtÄ±r</p>
                            <button onclick="comparePrices('eggs')" class="w-full py-2 gradient-primary text-white rounded-lg text-sm hover:opacity-90 transition-all" data-text="products.compare">
                                Fiyat KarÅŸÄ±laÅŸtÄ±r
                            </button>
                        </div>
                    </div>
                    
                    <div class="theme-bg-card rounded-xl p-6 card-premium trending-product" data-product="rice">
                        <div class="text-center">
                            <div class="w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center overflow-hidden">
                                <img src="https://images.unsplash.com/photo-1586201375761-83865001e8c3?w=64&h=64&fit=crop&crop=center" alt="Rice" class="w-full h-full object-cover rounded-full">
                            </div>
                            <h3 class="font-bold theme-text-primary mb-2" data-text="products.rice">PirinÃ§</h3>
                            <p class="theme-text-muted text-sm mb-4" data-text="products.compare_prices">En uygun fiyatlarÄ± karÅŸÄ±laÅŸtÄ±r</p>
                            <button onclick="comparePrices('rice')" class="w-full py-2 gradient-primary text-white rounded-lg text-sm hover:opacity-90 transition-all" data-text="products.compare">
                                Fiyat KarÅŸÄ±laÅŸtÄ±r
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Stats Dashboard -->
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="card-premium rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center stats-icon">
                            <i data-lucide="package" class="text-blue-600 dark:text-blue-400 w-6 h-6"></i>
                        </div>
                        <span id="productsCount" class="text-2xl font-bold theme-text-accent">245</span>
                    </div>
                    <h3 class="font-semibold theme-text-primary" data-text="stats.products">Produkty</h3>
                    <p class="text-sm theme-text-muted" data-text="stats.products_desc">W bazie danych</p>
                </div>
                
                <div class="card-premium rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-xl flex items-center justify-center stats-icon">
                            <i data-lucide="trending-down" class="text-green-600 dark:text-green-400 w-6 h-6"></i>
                        </div>
                        <span id="savingsAmount" class="text-2xl font-bold text-green-500">127.50 PLN</span>
                    </div>
                    <h3 class="font-semibold theme-text-primary" data-text="stats.savings">OszczÄ™dnoÅ›ci</h3>
                    <p class="text-sm theme-text-muted" data-text="stats.savings_desc">MiesiÄ™czne</p>
                </div>
                
                <div class="card-premium rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center stats-icon">
                            <i data-lucide="store" class="text-purple-600 dark:text-purple-400 w-6 h-6"></i>
                        </div>
                        <span class="text-2xl font-bold text-purple-500">12</span>
                    </div>
                    <h3 class="font-semibold theme-text-primary" data-text="stats.stores">Sklepy</h3>
                    <p class="text-sm theme-text-muted" data-text="stats.stores_desc">Aktywne</p>
                </div>
                
                <div class="card-premium rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-xl flex items-center justify-center stats-icon">
                            <i data-lucide="bell" class="text-red-600 dark:text-red-400 w-6 h-6"></i>
                        </div>
                        <span id="alertsCount" class="text-2xl font-bold text-red-500">8</span>
                    </div>
                    <h3 class="font-semibold theme-text-primary" data-text="stats.alerts">Alarmy</h3>
                    <p class="text-sm theme-text-muted" data-text="stats.alerts_desc">Aktywne</p>
                </div>
            </div>

            <!-- AI Recommendations -->
            <div class="card-premium rounded-2xl p-6 mb-8">
                <h3 class="text-xl font-bold theme-text-primary mb-4 flex items-center">
                    <i data-lucide="brain" class="w-6 h-6 mr-2 text-purple-500"></i>
                    <span data-text="ai.recommendations">AI Rekomendacje</span>
                </h3>
                <div id="aiRecommendations" class="space-y-4">
                    <!-- AI recommendations will be loaded here -->
                </div>
            </div>

            <!-- Recent Products -->
            <div class="card-premium rounded-2xl p-6">
                <h3 class="text-xl font-bold theme-text-primary mb-4" data-text="recent.products">Najnowsze Produkty</h3>
                <div id="recentProducts" class="grid gap-4">
                    <!-- Recent products will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Products Section -->
        <div id="products-section" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold theme-text-primary mb-4" data-text="products.catalog">Katalog ProduktÃ³w</h2>
                <div class="flex gap-4 mb-4">
                    <select id="categoryFilter" class="px-4 py-2 rounded-lg">
                        <option value="all" data-text="products.all_categories">Wszystkie kategorie</option>
                    </select>
                    <select id="sortFilter" class="px-4 py-2 rounded-lg">
                        <option value="name" data-text="products.sort_name">Sortuj po nazwie</option>
                        <option value="price" data-text="products.sort_price">Sortuj po cenie</option>
                        <option value="savings" data-text="products.sort_savings">Sortuj po oszczÄ™dnoÅ›ciach</option>
                    </select>
                </div>
            </div>
            <div id="productsGrid" class="grid gap-6">
                <!-- Products will be loaded here -->
            </div>
        </div>

        <!-- Shopping List Section -->
        <div id="shopping-list-section" class="section hidden">
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="card-premium rounded-2xl p-6">
                    <h3 class="text-xl font-bold theme-text-primary mb-4" data-text="shopping.title">Twoja Lista ZakupÃ³w</h3>
                    <div id="shoppingListContainer">
                        <!-- Shopping list will be loaded here -->
                    </div>
                    <button onclick="optimizeRoute()" class="btn-primary w-full mt-4 py-3 rounded-lg font-semibold" data-text="shopping.optimize_route">
                        ðŸš€ Optymalizuj TrasÄ™
                    </button>
                </div>
                
                <div class="card-premium rounded-2xl p-6">
                    <h3 class="text-xl font-bold theme-text-primary mb-4" data-text="shopping.optimized_route">Optymalna Trasa</h3>
                    <div id="optimizedRoute">
                        <!-- Optimized route will be shown here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Section -->
        <div id="analytics-section" class="section hidden">
            <h2 class="text-3xl font-bold theme-text-primary mb-6" data-text="analytics.title">Analityka i Raporty</h2>
            
            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <div class="card-premium rounded-2xl p-6">
                    <h3 class="text-xl font-bold theme-text-primary mb-4" data-text="analytics.price_trends">Historia Cen</h3>
                    <canvas id="priceChart" width="400" height="200"></canvas>
                </div>
                
                <div class="card-premium rounded-2xl p-6">
                    <h3 class="text-xl font-bold theme-text-primary mb-4" data-text="analytics.savings_breakdown">OszczÄ™dnoÅ›ci</h3>
                    <canvas id="savingsChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <div class="card-premium rounded-2xl p-6">
                <h3 class="text-xl font-bold theme-text-primary mb-4" data-text="analytics.price_alerts">Aktywne Alarmy Cenowe</h3>
                <div id="priceAlerts">
                    <!-- Price alerts will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Shops Section -->
        <div id="shops-section" class="section hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-bold theme-text-primary mb-4 flex items-center">
                    <i class="lucide-store w-8 h-8 mr-3 theme-text-accent"></i>
                    <span data-text="shops.title">MaÄŸazalar</span>
                </h2>
                <p class="text-xl theme-text-secondary" data-text="shops.description">
                    TÃ¼m maÄŸazalarÄ± keÅŸfedin ve en uygun fiyatlarÄ± bulun
                </p>
            </div>

            <!-- Back Button for Store Navigation -->
            <div id="shopBackButton" class="hidden mb-6">
                <button onclick="goBackToStores()" class="flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all transform hover:scale-105">
                    <i class="lucide-arrow-left w-5 h-5 mr-2"></i>
                    <span data-text="shops.back_to_stores">MaÄŸazalara DÃ¶n</span>
                </button>
            </div>

            <!-- Main Stores Grid -->
            <div id="storesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
                <!-- Lidl -->
                <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreDetails('lidl')">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce overflow-hidden">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Lidl-Logo.svg/200px-Lidl-Logo.svg.png" alt="Lidl" class="w-full h-full object-contain bg-white p-2 rounded-full">
                        </div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">Lidl</h4>
                            <p class="text-sm theme-text-muted">Alman sÃ¼permarket zinciri</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">GÄ±da</span>
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">Ev & BahÃ§e</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">Tekstil</span>
                        <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm">Elektronik</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-green-600">245 Ã¼rÃ¼n</span>
                        <span class="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full">%15 indirim</span>
                    </div>
                    <!-- Hover Tooltip -->
                    <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                            Lidl: GÄ±da, Ev & BahÃ§e, Tekstil, Elektronik - 245 Ã¼rÃ¼n
                        </div>
                    </div>
                </div>

                <!-- BÄ°M -->
                <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreDetails('bim')">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce">
                            <span class="text-white font-bold text-xl">BÄ°M</span>
                        </div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">BÄ°M</h4>
                            <p class="text-sm theme-text-muted">BirleÅŸik MaÄŸazalar A.Åž.</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">GÄ±da</span>
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">Temizlik</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">Kozmetik</span>
                        <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm">Tekstil</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-green-600">189 Ã¼rÃ¼n</span>
                        <span class="text-sm bg-red-100 text-red-800 px-2 py-1 rounded-full">%12 indirim</span>
                    </div>
                    <!-- Hover Tooltip -->
                    <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                            BÄ°M: GÄ±da, Temizlik, Kozmetik, Tekstil - 189 Ã¼rÃ¼n
                        </div>
                    </div>
                </div>

                <!-- Migros -->
                <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreDetails('migros')">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce">
                            <span class="text-white font-bold text-lg">M</span>
                        </div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">Migros</h4>
                            <p class="text-sm theme-text-muted">Migros Ticaret A.Åž.</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">GÄ±da</span>
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">Elektronik</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">Ev & YaÅŸam</span>
                        <span class="px-3 py-1 bg-pink-100 text-pink-800 rounded-full text-sm">KiÅŸisel BakÄ±m</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-green-600">312 Ã¼rÃ¼n</span>
                        <span class="text-sm bg-orange-100 text-orange-800 px-2 py-1 rounded-full">%18 indirim</span>
                    </div>
                    <!-- Hover Tooltip -->
                    <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                            Migros: GÄ±da, Elektronik, Ev & YaÅŸam, KiÅŸisel BakÄ±m - 312 Ã¼rÃ¼n
                        </div>
                    </div>
                </div>

                <!-- Åžok -->
                <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreDetails('sok')">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-purple-600 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce">
                            <span class="text-white font-bold text-xl">ÅžOK</span>
                        </div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">ÅžOK</h4>
                            <p class="text-sm theme-text-muted">Åžok Marketler A.Åž.</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">GÄ±da</span>
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">Temizlik</span>
                        <span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm">Oyuncak</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">KÄ±rtasiye</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-green-600">156 Ã¼rÃ¼n</span>
                        <span class="text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded-full">%10 indirim</span>
                    </div>
                    <!-- Hover Tooltip -->
                    <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                            ÅžOK: GÄ±da, Temizlik, Oyuncak, KÄ±rtasiye - 156 Ã¼rÃ¼n
                        </div>
                    </div>
                </div>

                <!-- A101 -->
                <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreDetails('a101')">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce">
                            <span class="text-white font-bold text-lg">A101</span>
                        </div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">A101</h4>
                            <p class="text-sm theme-text-muted">A101 Yeni MaÄŸazacÄ±lÄ±k A.Åž.</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">GÄ±da</span>
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">Ev EÅŸyasÄ±</span>
                        <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm">Tekstil</span>
                        <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm">Teknoloji</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-green-600">198 Ã¼rÃ¼n</span>
                        <span class="text-sm bg-green-100 text-green-800 px-2 py-1 rounded-full">%14 indirim</span>
                    </div>
                    <!-- Hover Tooltip -->
                    <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                            A101: GÄ±da, Ev EÅŸyasÄ±, Tekstil, Teknoloji - 198 Ã¼rÃ¼n
                        </div>
                    </div>
                </div>

                <!-- CarrefourSA -->
                <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreDetails('carrefour')">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-blue-800 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce">
                            <span class="text-white font-bold text-sm">CarrefourSA</span>
                        </div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">CarrefourSA</h4>
                            <p class="text-sm theme-text-muted">CarrefourSA A.Åž.</p>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">GÄ±da</span>
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">Elektronik</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">Ev & BahÃ§e</span>
                        <span class="px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm">Spor</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-green-600">423 Ã¼rÃ¼n</span>
                        <span class="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full">%16 indirim</span>
                    </div>
                    <!-- Hover Tooltip -->
                    <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                        <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                            CarrefourSA: GÄ±da, Elektronik, Ev & BahÃ§e, Spor - 423 Ã¼rÃ¼n
                        </div>
                    </div>
                </div>
            </div>

            <!-- Store Details View -->
            <div id="storeDetailsView" class="hidden">
                <!-- Store header -->
                <div id="storeHeader" class="mb-8">
                    <!-- Will be populated with store details -->
                </div>

                <!-- Store categories -->
                <div id="storeCategoriesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Will be populated with store categories -->
                </div>

                <!-- Store products -->
                <div id="storeProductsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Will be populated with store products -->
                </div>
            </div>
        </div>
    </main>

    <script>
        // Configuration
        const API_BASE = window.location.hostname === 'localhost' ? 'http://localhost:3001/api' : '/api';
        
        // Global state
        let currentSection = 'home';
        let products = [];
        let shoppingList = [];
        let recommendations = [];
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            
            // Apply theme
            applyTheme();
            
            // Load application data
            initializeApp();
            
            // Show welcome message
            setTimeout(() => {
                const welcomeMsg = getTranslation('welcome_message', translations[currentLanguage]) || 'SmartShop AI\'ya hoÅŸ geldiniz! ðŸ›’âœ¨';
                showNotification(welcomeMsg, 'info');
            }, 1000);
        });

        // App initialization
        function initializeApp() {
            try {
                // Initialize theme
                initializeTheme();
                
                // Initialize multilingual system
                initializeTranslations();
                
                // Initialize AI system
                initializeAI();
                
                // Initialize new features
                initializeFlyers();
                initializePriceData();
                
                // Initialize map
                setTimeout(() => {
                    initializeMap();
                }, 500);
                
                // Start auto-save for demo
                startAutoSave();
                
                showNotification('âœ… SmartShop AI loaded successfully!', 'success');
            } catch (error) {
                console.error('Initialization error:', error);
                showNotification('âš ï¸ Some features may not work properly', 'warning');
            }
        }

        function applyTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeToggle();
        }

        function initializeTheme() {
            applyTheme();
        }

        function initializeTranslations() {
            updateLanguage();
        }

        function initializeAI() {
            // AI system placeholder
            console.log('AI system initialized');
        }

        function startAutoSave() {
            // Auto-save placeholder
            console.log('Auto-save started');
        }

        // API Functions
        async function apiCall(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });
                
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API call failed:', endpoint, error);
                // Return demo data as fallback
                return getDemoData(endpoint);
            }
        }

        // Demo data fallback
        function getDemoData(endpoint) {
            const demoData = {
                '/products': {
                    success: true,
                    data: [
                        {
                            id: '1',
                            name: 'Mleko UHT 3.2% 1L',
                            description: 'Åaciate, Å›wieÅ¼e mleko UHT',
                            category: 'NabiaÅ‚',
                            brand: 'Åaciate',
                            image: 'https://images.unsplash.com/photo-1563636619-e9143da7973b?w=200&h=200&fit=crop',
                            rating: 4.8,
                            reviewCount: 2341,
                            prices: [
                                { store: 'LIDL', price: 3.49, isLowest: true, discount: 0.7 },
                                { store: 'Biedronka', price: 3.99, isLowest: false, discount: 0.2 },
                                { store: 'Auchan', price: 4.19, isLowest: false, discount: 0 }
                            ]
                        },
                        {
                            id: '2',
                            name: 'Chleb Å»ytni 500g',
                            description: 'Tradycyjny chleb Å¼ytni',
                            category: 'Pieczywo',
                            brand: 'Kaszubski',
                            image: 'https://images.unsplash.com/photo-1509440159596-0249088772ff?w=200&h=200&fit=crop',
                            rating: 4.6,
                            reviewCount: 1289,
                            prices: [
                                { store: 'Biedronka', price: 2.89, isLowest: true, discount: 0.6 },
                                { store: 'LIDL', price: 3.19, isLowest: false, discount: 0.3 },
                                { store: 'Auchan', price: 3.49, isLowest: false, discount: 0 }
                            ]
                        }
                    ]
                },
                '/ai/recommendations': {
                    success: true,
                    data: [
                        {
                            id: '1',
                            type: 'product',
                            title: 'Sugerujemy dodaÄ‡:',
                            message: 'Jajka - promocja w LIDL -25%',
                            action: 'add_to_list',
                            priority: 'high'
                        }
                    ]
                },
                '/shopping-list': {
                    success: true,
                    data: [
                        {
                            id: '1',
                            name: 'Zakupy Tygodniowe',
                            items: [],
                            totalAmount: 0,
                            estimatedSavings: 0
                        }
                    ]
                },
                '/prices/alerts': {
                    success: true,
                    data: []
                }
            };
            
            return demoData[endpoint] || { success: false, data: [] };
        }

        // Data loading functions
        async function loadProducts() {
            const response = await apiCall('/products');
            if (response.success) {
                products = response.data;
                renderProducts();
                updateProductsCount();
            }
        }

        async function loadShoppingList() {
            const response = await apiCall('/shopping-list');
            if (response.success && response.data.length > 0) {
                shoppingList = response.data[0].items || [];
                renderShoppingList();
            }
        }

        async function loadAIRecommendations() {
            const response = await apiCall('/ai/recommendations', {
                method: 'POST',
                body: JSON.stringify({ userId: 'demo', currentList: shoppingList })
            });
            if (response.success) {
                recommendations = response.data;
                renderAIRecommendations();
            }
        }

        async function loadPriceAlerts() {
            const response = await apiCall('/prices/alerts');
            if (response.success) {
                renderPriceAlerts(response.data);
                updateAlertsCount(response.data.length);
            }
        }

        async function checkAPIStatus() {
            try {
                await apiCall('/health');
                document.getElementById('apiStatus').textContent = 'Online';
                document.getElementById('apiStatus').className = 'font-medium text-green-500';
            } catch (error) {
                document.getElementById('apiStatus').textContent = 'Demo Mode';
                document.getElementById('apiStatus').className = 'font-medium text-yellow-600';
            }
        }

        // Rendering functions
        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            const recentGrid = document.getElementById('recentProducts');
            
            const productHTML = products.map(product => `
                <div class="product-card rounded-xl p-6 shadow-lg card-premium">
                    <div class="flex gap-4">
                        <img src="${product.image}" alt="${product.name}" class="product-image w-24 h-24 object-cover rounded-lg">
                        <div class="flex-1">
                            <h4 class="font-semibold theme-text-primary mb-2">${product.name}</h4>
                            <p class="theme-text-secondary text-sm mb-2">${product.description}</p>
                            <div class="flex items-center mb-3">
                                <span class="text-yellow-500 mr-1">â­</span>
                                <span class="text-sm theme-text-muted">${product.rating} (${product.reviewCount} deÄŸerlendirme)</span>
                            </div>
                            <div class="flex gap-2 mb-3">
                                ${product.prices.map(price => `
                                    <span class="px-2 py-1 rounded text-xs font-medium ${getStoreClass(price.store)}">
                                        ${price.store}: ${price.price} TL
                                        ${price.isLowest ? 'ðŸ†' : ''}
                                    </span>
                                `).join('')}
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-green-500 font-semibold">
                                    ðŸ’° Tasarruf: ${Math.max(...product.prices.map(p => p.discount))} TL
                                </span>
                                <button onclick="addToShoppingList('${product.id}')" 
                                        class="btn-primary px-4 py-2 rounded-lg transition-all">
                                    Dodaj do Listy
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            if (grid) grid.innerHTML = productHTML;
            if (recentGrid) recentGrid.innerHTML = productHTML;
        }

        function renderAIRecommendations() {
            const container = document.getElementById('aiRecommendations');
            if (!container) return;
            
            const html = recommendations.map(rec => `
                <div class="card-premium border-blue-200 dark:border-blue-800 rounded-lg p-4">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 gradient-primary rounded-full flex items-center justify-center">
                            <i data-lucide="lightbulb" class="text-white w-4 h-4"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold theme-text-primary">${rec.title}</h4>
                            <p class="theme-text-secondary mt-1">${rec.message}</p>
                            ${rec.action ? `
                                <button onclick="handleRecommendationAction('${rec.action}', '${rec.productId || ''}')" 
                                        class="theme-text-accent text-sm font-medium mt-2 hover:underline">
                                    Akcja
                                </button>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
            lucide.createIcons();
        }

        function renderShoppingList() {
            const container = document.getElementById('shoppingListContainer');
            if (!container) return;
            
            if (shoppingList.length === 0) {
                container.innerHTML = '<p class="theme-text-muted text-center py-8">AlÄ±ÅŸveriÅŸ listesi boÅŸ</p>';
                return;
            }
            
            const html = shoppingList.map(item => `
                <div class="flex items-center justify-between card-premium p-4 rounded-lg mb-2">
                    <div class="flex items-center space-x-3">
                        <input type="checkbox" class="w-5 h-5 text-blue-600">
                        <span class="theme-text-primary">${item.name}</span>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold theme-text-primary">${item.price} TL</div>
                        <div class="text-sm theme-text-muted">${item.selectedStore}</div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
        }

        function renderPriceAlerts(alerts) {
            const container = document.getElementById('priceAlerts');
            if (!container) return;
            
            if (alerts.length === 0) {
                container.innerHTML = '<p class="theme-text-muted text-center py-8">Aktif fiyat uyarÄ±sÄ± yok</p>';
                return;
            }
            
            const html = alerts.map(alert => `
                <div class="flex items-center justify-between p-4 card-premium rounded-lg mb-2">
                    <div>
                        <h4 class="font-semibold theme-text-primary">${alert.productName}</h4>
                        <p class="text-sm theme-text-secondary">Hedef: ${alert.targetPrice} TL</p>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold theme-text-primary">${alert.currentPrice} TL</div>
                        <div class="text-sm ${alert.status === 'triggered' ? 'text-green-500' : 'text-yellow-500'}">
                            ${alert.status === 'triggered' ? 'UlaÅŸÄ±ldÄ±!' : 'Aktif'}
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
        }

        // Helper functions
        function getStoreClass(store) {
            const classes = {
                'LIDL': 'bg-blue-100 text-blue-800',
                'BÄ°M': 'bg-red-100 text-red-800',
                'Migros': 'bg-orange-100 text-orange-800',
                'Åžok': 'bg-purple-100 text-purple-800',
                'A101': 'bg-green-100 text-green-800'
            };
            return classes[store] || 'bg-gray-100 text-gray-800';
        }

        function updateDashboard() {
            updateProductsCount();
            updateSavingsAmount();
            updateAlertsCount(0);
        }

        function updateProductsCount() {
            const element = document.getElementById('productsCount');
            if (element) element.textContent = products.length;
        }

        function updateSavingsAmount() {
            const totalSavings = products.reduce((sum, product) => 
                sum + Math.max(...product.prices.map(p => p.discount)), 0
            );
            const element = document.getElementById('savingsAmount');
            if (element) element.textContent = `${totalSavings.toFixed(2)} TL`;
        }

        function updateAlertsCount(count) {
            const element = document.getElementById('alertsCount');
            if (element) element.textContent = count;
        }

        // Action functions
        async function searchProducts() {
            const searchTerm = document.getElementById('globalSearch').value;
            if (!searchTerm) return;
            
            showNotification(`ðŸ” Szukam: "${searchTerm}"...`, 'info');
            
            try {
                const response = await apiCall(`/products?search=${encodeURIComponent(searchTerm)}`);
                if (response.success) {
                    products = response.data;
                    renderProducts();
                    showSection('products');
                    showNotification(`âœ… Znaleziono ${products.length} produktÃ³w`, 'success');
                }
            } catch (error) {
                showNotification('âš ï¸ BÅ‚Ä…d wyszukiwania', 'error');
            }
        }

        async function addToShoppingList(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const lowestPrice = product.prices.reduce((min, p) => p.price < min.price ? p : min);
            
            const newItem = {
                id: Date.now().toString(),
                productId: productId,
                name: product.name,
                quantity: 1,
                selectedStore: lowestPrice.store,
                price: lowestPrice.price,
                totalPrice: lowestPrice.price
            };
            
            shoppingList.push(newItem);
            renderShoppingList();
            showNotification(`âœ… ${product.name} dodane do listy!`, 'success');
        }

        async function triggerScraping() {
            const button = document.querySelector('button[onclick="triggerScraping()"]');
            const originalHTML = button.innerHTML;
            
            button.innerHTML = '<div class="loading-spinner"></div>';
            button.disabled = true;
            
            showNotification('ðŸ”„ Rozpoczynam aktualizacjÄ™ cen...', 'info');
            
            try {
                const response = await apiCall('/scraper/run', {
                    method: 'POST',
                    body: JSON.stringify({ stores: ['LIDL', 'Biedronka', 'Auchan'] })
                });
                
                if (response.success) {
                    showNotification('âœ… Ceny zaktualizowane pomyÅ›lnie!', 'success');
                    await loadProducts(); // Reload products with new prices
                } else {
                    showNotification('âš ï¸ BÅ‚Ä…d aktualizacji cen', 'warning');
                }
            } catch (error) {
                showNotification('âŒ Nie moÅ¼na zaktualizowaÄ‡ cen', 'error');
            } finally {
                button.innerHTML = originalHTML;
                button.disabled = false;
                lucide.createIcons();
            }
        }

        async function optimizeRoute() {
            if (shoppingList.length === 0) {
                showNotification('âš ï¸ Lista zakupÃ³w jest pusta', 'warning');
                return;
            }
            
            showNotification('ðŸš€ OptymalizujÄ™ trasÄ™...', 'info');
            
            try {
                const response = await apiCall('/shopping-list/1/optimize', {
                    method: 'POST'
                });
                
                if (response.success) {
                    renderOptimizedRoute(response.data);
                    showNotification('âœ… Trasa zoptymalizowana!', 'success');
                }
            } catch (error) {
                showNotification('âš ï¸ BÅ‚Ä…d optymalizacji trasy', 'error');
            }
        }

        function renderOptimizedRoute(routeData) {
            const container = document.getElementById('optimizedRoute');
            if (!container) return;
            
            const html = `
                <div class="space-y-4">
                    <div class="card-premium p-4 rounded-lg border-l-4 border-green-500">
                        <h4 class="font-semibold theme-text-primary flex items-center">
                            <i data-lucide="route" class="w-5 h-5 mr-2 text-green-500"></i>
                            Optymalna Trasa:
                        </h4>
                        <p class="theme-text-secondary mt-2">${routeData.route.join(' â†’ ')}</p>
                        <div class="grid grid-cols-2 gap-4 mt-4 text-sm">
                            <div class="flex items-center theme-text-muted">
                                <i data-lucide="clock" class="w-4 h-4 mr-1"></i>
                                Czas: ${routeData.estimatedTime} min
                            </div>
                            <div class="flex items-center text-green-500">
                                <i data-lucide="piggy-bank" class="w-4 h-4 mr-1"></i>
                                OszczÄ™dnoÅ›Ä‡: ${routeData.totalSavings} PLN
                            </div>
                        </div>
                    </div>
                    
                    ${routeData.storeDetails.map(store => `
                        <div class="card-premium p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h5 class="font-semibold theme-text-primary flex items-center">
                                    <i data-lucide="store" class="w-4 h-4 mr-2 text-purple-500"></i>
                                    ${store.store}
                                </h5>
                                <span class="text-sm theme-text-muted">${store.items.length} produktÃ³w</span>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold theme-text-accent">Razem: ${store.subtotal.toFixed(2)} PLN</p>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            container.innerHTML = html;
            lucide.createIcons();
        }

        function handleRecommendationAction(action, productId) {
            switch (action) {
                case 'add_to_list':
                    if (productId) addToShoppingList(productId);
                    break;
                case 'buy_now':
                    showNotification('ðŸ›’ Przekierowanie do sklepu...', 'info');
                    break;
                default:
                    showNotification('â„¹ï¸ Akcja wykonana', 'info');
            }
        }

        async function refreshAllData() {
            const button = document.getElementById('refreshDataBtn');
            const icon = button.querySelector('i');
            
            icon.style.animation = 'spin 1s linear infinite';
            
            try {
                await initializeApp();
                showNotification('ðŸ”„ Dane odÅ›wieÅ¼one!', 'success');
            } catch (error) {
                showNotification('âš ï¸ BÅ‚Ä…d odÅ›wieÅ¼ania', 'error');
            } finally {
                icon.style.animation = '';
            }
        }

        // Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-button-v2').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(`${sectionId}-section`);
            if (section) {
                section.classList.remove('hidden');
            }
            
            // Add active class to clicked button
            event.target.closest('.nav-button-v2').classList.add('active');
            
            // Special handling for products - show shops section with products view
            if (sectionId === 'products') {
                document.getElementById('shops-section').classList.remove('hidden');
                showShops(); // This will show the products section with all categories
            }
            
            // Update language for the new section
            updateLanguage();
        }

        // Analytics
        function loadAnalytics() {
            // Price chart
            const priceCtx = document.getElementById('priceChart');
            if (priceCtx) {
                new Chart(priceCtx, {
                    type: 'line',
                    data: {
                        labels: ['Pn', 'Wt', 'Åšr', 'Cz', 'Pt', 'Sb', 'Nd'],
                        datasets: [{
                            label: 'Åšrednia cena (PLN)',
                            data: [3.89, 3.85, 3.82, 3.79, 3.76, 3.73, 3.70],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
            
            // Savings chart
            const savingsCtx = document.getElementById('savingsChart');
            if (savingsCtx) {
                new Chart(savingsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['LIDL', 'Biedronka', 'Auchan'],
                        datasets: [{
                            data: [45, 35, 20],
                            backgroundColor: ['#0050aa', '#e31e24', '#ff6900']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { position: 'bottom' }
                        }
                    }
                });
            }
        }

        // Notifications
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notifications');
            const id = Date.now();
            
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            const notification = document.createElement('div');
            notification.id = `notification-${id}`;
            notification.className = `notification ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg max-w-sm`;
            notification.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="hideNotification('${id}')" class="ml-4 text-white">Ã—</button>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Show notification
            setTimeout(() => notification.classList.add('show'), 100);
            
            // Auto hide after 5 seconds
            setTimeout(() => hideNotification(id), 5000);
        }

        function hideNotification(id) {
            const notification = document.getElementById(`notification-${id}`);
            if (notification) {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }
        }

        // Load demo data if API is not available
        function loadDemoData() {
            products = getDemoData('/products').data;
            recommendations = getDemoData('/ai/recommendations').data;
            renderProducts();
            renderAIRecommendations();
            updateDashboard();
        }

        // Enter key for search
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.activeElement.id === 'globalSearch') {
                searchProducts();
            }
        });

        // ============= THEME SYSTEM =============
        
        // Initialize theme on page load
        function initializeTheme() {
            const savedTheme = localStorage.getItem('smartshop_theme') || 'light';
            applyTheme(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme(newTheme);
            
            // Enhanced visual feedback
            const toggle = document.querySelector('.theme-toggle');
            toggle.style.transform = 'scale(0.9)';
            
            setTimeout(() => {
                toggle.style.transform = 'scale(1)';
            }, 150);
            
            // Show enhanced notification with icons
            const message = newTheme === 'dark' 
                ? 'ðŸŒ™ KaranlÄ±k mod aktif - GÃ¶zleriniz teÅŸekkÃ¼r ediyor!' 
                : 'â˜€ï¸ AydÄ±nlÄ±k mod aktif - GÃ¼neÅŸli gÃ¶rÃ¼nÃ¼m!';
            showNotification(message, 'success');
            
            // Add glow effect to all cards
            document.querySelectorAll('.card-premium').forEach(card => {
                card.style.transition = 'all 0.6s ease';
                card.style.transform = 'scale(1.01)';
                setTimeout(() => {
                    card.style.transform = 'scale(1)';
                }, 300);
            });
        }

        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('smartshop_theme', theme);
            
            // Update theme toggle appearance with smooth transition
            const toggle = document.querySelector('.theme-toggle');
            if (toggle) {
                toggle.style.transition = 'all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
            }
            
            // Update scrollbar color smoothly
            document.documentElement.style.setProperty('--scrollbar-track', 
                theme === 'dark' ? '#1e293b' : '#f1f5f9'
            );
            document.documentElement.style.setProperty('--scrollbar-thumb', 
                theme === 'dark' ? '#334155' : '#cbd5e1'
            );
        }

        // ============= END THEME SYSTEM =============

        // ============= MULTILINGUAL SYSTEM =============
        
        // Translation data
        const translations = {
            tr: {
                subtitle: "Tam Uygulama",
                hero: {
                    description: "Konum tabanlÄ± market bulucu ve promosyon broÅŸÃ¼rleri ile AI destekli alÄ±ÅŸveriÅŸ optimizasyonu",
                    start_optimization: "Optimizasyonu BaÅŸlat",
                    watch_demo: "Demo Ä°zle"
                },
                location: {
                    title: "YakÄ±ndaki Marketleri KeÅŸfet",
                    placeholder: "Konum girin (Ã¶rn: KadÄ±kÃ¶y, Ä°stanbul)",
                    current: "Konumum",
                    find_stores: "Market Bul",
                    enter_location: "LÃ¼tfen bir konum girin veya haritadan seÃ§in",
                    searching: "YakÄ±ndaki marketler aranÄ±yor...",
                    stores_found: "{count} market bulundu!",
                    search_error: "Marketler aranÄ±rken bir hata oluÅŸtu.",
                    getting_location: "Konum alÄ±nÄ±yor...",
                    location_success: "Konum baÅŸarÄ±yla alÄ±ndÄ±!",
                    address_error: "Adres bilgisi alÄ±namadÄ±",
                    location_denied: "Konum izni reddedildi",
                    no_geolocation: "TarayÄ±cÄ±nÄ±z konum hizmetini desteklemiyor",
                    current_location_marker: "Mevcut Konumunuz"
                },
                flyers: {
                    title: "Market AktÃ¼elleri ve Kampanyalar",
                    description: "HaftalÄ±k kampanyalarÄ± tek yerden takip edin, tek tÄ±kla sepete ekleyin",
                    all: "TÃ¼mÃ¼"
                },
                price: {
                    title: "AkÄ±llÄ± Fiyat KarÅŸÄ±laÅŸtÄ±rma",
                    description: "AI destekli fiyat analizi ile en uygun fÄ±rsatlarÄ± yakalayÄ±n",
                    search_placeholder: "ÃœrÃ¼n adÄ± veya barkod numarasÄ± girin...",
                    search: "Fiyat Ara"
                },
                products: {
                    bread: "Ekmek",
                    milk: "SÃ¼t",
                    eggs: "Yumurta",
                    rice: "PirinÃ§",
                    compare_prices: "En uygun fiyatlarÄ± karÅŸÄ±laÅŸtÄ±r",
                    compare: "Fiyat KarÅŸÄ±laÅŸtÄ±r",
                    catalog: "ÃœrÃ¼n Katalogu",
                    all_categories: "TÃ¼m Kategoriler",
                    sort_name: "Ä°sme GÃ¶re SÄ±rala",
                    sort_price: "Fiyata GÃ¶re SÄ±rala",
                    sort_savings: "Tasarrufa GÃ¶re SÄ±rala"
                },
                shops: {
                    description: "TÃ¼m maÄŸaza ve Ã¼rÃ¼n kategorilerini keÅŸfedin"
                },
                nav: {
                    dashboard: "Ana Sayfa",
                    products: "ÃœrÃ¼nler",
                    shops: "Shops",
                    shopping_list: "Lista ZakupÃ³w",
                    analytics: "Analityka"
                },
                status: "Durum",
                "status.online": "Ã‡evrimiÃ§i",
                "status.offline": "Ã‡evrimdÄ±ÅŸÄ±",
                search: {
                    placeholder: "ÃœrÃ¼n ara (Ã¶rn. sÃ¼t, ekmek)"
                },
                stats: {
                    products: "ÃœrÃ¼nler",
                    products_desc: "VeritabanÄ±nda",
                    savings: "Tasarruf",
                    savings_desc: "AylÄ±k",
                    stores: "Marketler", 
                    stores_desc: "Aktif",
                    alerts: "UyarÄ±lar",
                    alerts_desc: "Aktif"
                },
                ai: {
                    recommendations: "AI Ã–nerileri"
                },
                recent: {
                    products: "En Yeni ÃœrÃ¼nler"
                },
                analytics: {
                    title: "Analitik ve Raporlar",
                    price_trends: "Fiyat Trendleri",
                    savings_breakdown: "Tasarruf DaÄŸÄ±lÄ±mÄ±",
                    monthly_savings: "AylÄ±k tasarruf",
                    price_alerts: "Fiyat UyarÄ±larÄ±"
                },
                shopping: {
                    title: "AlÄ±ÅŸveriÅŸ Listesi",
                    create_new: "Yeni liste oluÅŸtur",
                    optimize_route: "RotayÄ± optimize et",
                    optimized_route: "Optimize Rota",
                    your_lists: "Listeleriniz",
                    total: "Toplam",
                    items: "Ã¼rÃ¼n"
                }
            },
            pl: {
                subtitle: "PeÅ‚na Aplikacja",
                hero: {
                    description: "Optymalizacja zakupÃ³w oparta na AI z wyszukiwarkÄ… sklepÃ³w lokalnych i ulotek promocyjnych",
                    start_optimization: "Rozpocznij OptymalizacjÄ™",
                    watch_demo: "Zobacz Demo"
                },
                location: {
                    title: "Odkryj Pobliskie Sklepy",
                    placeholder: "WprowadÅº lokalizacjÄ™ (np. KrakÃ³w, Polska)",
                    current: "Moja lokalizacja",
                    find_stores: "ZnajdÅº Sklepy",
                    enter_location: "ProszÄ™ wprowadziÄ‡ lokalizacjÄ™ lub wybraÄ‡ na mapie",
                    searching: "Szukam pobliskich sklepÃ³w...",
                    stores_found: "Znaleziono {count} sklepÃ³w!",
                    search_error: "BÅ‚Ä…d podczas wyszukiwania sklepÃ³w.",
                    getting_location: "Pobieranie lokalizacji...",
                    location_success: "Lokalizacja pobrana pomyÅ›lnie!",
                    address_error: "Nie moÅ¼na pobraÄ‡ informacji o adresie",
                    location_denied: "OdmÃ³wiono dostÄ™pu do lokalizacji",
                    no_geolocation: "Twoja przeglÄ…darka nie obsÅ‚uguje geolokalizacji",
                    current_location_marker: "Twoja obecna lokalizacja"
                },
                flyers: {
                    title: "Gazetki Promocyjne i Kampanie",
                    description: "ÅšledÅº tygodniowe promocje w jednym miejscu, dodaj do koszyka jednym klikniÄ™ciem",
                    all: "Wszystkie"
                },
                price: {
                    title: "Inteligentne PorÃ³wnanie Cen",
                    description: "ZnajdÅº najlepsze okazje dziÄ™ki analizie cen opartej na AI",
                    search_placeholder: "WprowadÅº nazwÄ™ produktu lub kod kreskowy...",
                    search: "Szukaj Cen"
                },
                products: {
                    bread: "Chleb",
                    milk: "Mleko",
                    eggs: "Jajka",
                    rice: "RyÅ¼",
                    compare_prices: "PorÃ³wnaj najlepsze ceny",
                    compare: "PorÃ³wnaj Ceny",
                    catalog: "Katalog ProduktÃ³w",
                    all_categories: "Wszystkie kategorie",
                    sort_name: "Sortuj po nazwie",
                    sort_price: "Sortuj po cenie",
                    sort_savings: "Sortuj po oszczÄ™dnoÅ›ciach"
                },
                shops: {
                    description: "Odkryj wszystkie sklepy i kategorie produktÃ³w"
                },
                nav: {
                    dashboard: "Dashboard",
                    products: "Produkty",
                    shops: "Shops",
                    shopping_list: "Lista ZakupÃ³w",
                    analytics: "Analityka"
                },
                status: "Status",
                "status.online": "Online",
                "status.offline": "Offline",
                search: {
                    placeholder: "Wyszukaj produkty (np. mleko, chleb)"
                },
                stats: {
                    products: "Produkty",
                    products_desc: "W bazie danych",
                    savings: "OszczÄ™dnoÅ›ci",
                    savings_desc: "MiesiÄ™czne",
                    stores: "Sklepy",
                    stores_desc: "Aktywne",
                    alerts: "Alarmy",
                    alerts_desc: "Aktywne"
                },
                ai: {
                    recommendations: "AI Rekomendacje"
                },
                recent: {
                    products: "Najnowsze Produkty"
                },
                analytics: {
                    title: "Analityka i Raporty",
                    price_trends: "Trendy Cenowe",
                    savings_breakdown: "PodziaÅ‚ OszczÄ™dnoÅ›ci",
                    monthly_savings: "MiesiÄ™czne oszczÄ™dnoÅ›ci",
                    price_alerts: "Alerty Cenowe"
                },
                shopping: {
                    title: "Lista ZakupÃ³w",
                    create_new: "UtwÃ³rz nowÄ… listÄ™",
                    optimize_route: "Optymalizuj trasÄ™",
                    optimized_route: "Optymalna Trasa",
                    your_lists: "Twoje listy",
                    total: "Razem",
                    items: "produktÃ³w"
                }
            },
            en: {
                subtitle: "Full Application",
                hero: {
                    description: "AI-powered shopping optimization with location-based store finder and promotional flyers",
                    start_optimization: "Start Optimization",
                    watch_demo: "Watch Demo"
                },
                location: {
                    title: "Discover Nearby Stores",
                    placeholder: "Enter location (e.g. London, UK)",
                    current: "My Location",
                    find_stores: "Find Stores",
                    enter_location: "Please enter a location or select on map",
                    searching: "Searching for nearby stores...",
                    stores_found: "Found {count} stores!",
                    search_error: "Error occurred while searching for stores.",
                    getting_location: "Getting location...",
                    location_success: "Location retrieved successfully!",
                    address_error: "Could not retrieve address information",
                    location_denied: "Location access denied",
                    no_geolocation: "Your browser doesn't support geolocation",
                    current_location_marker: "Your Current Location"
                },
                flyers: {
                    title: "Store Flyers and Promotions",
                    description: "Track weekly promotions from one place, add to cart with one click",
                    all: "All"
                },
                price: {
                    title: "Smart Price Comparison",
                    description: "Find the best deals with AI-powered price analysis",
                    search_placeholder: "Enter product name or barcode...",
                    search: "Search Prices"
                },
                products: {
                    bread: "Bread",
                    milk: "Milk",
                    eggs: "Eggs",
                    rice: "Rice",
                    compare_prices: "Compare best prices",
                    compare: "Compare Prices",
                    catalog: "Product Catalog",
                    all_categories: "All Categories",
                    sort_name: "Sort by Name",
                    sort_price: "Sort by Price",
                    sort_savings: "Sort by Savings"
                },
                shops: {
                    description: "Discover all stores and product categories"
                },
                nav: {
                    dashboard: "Dashboard",
                    products: "Products",
                    shops: "Shops",
                    shopping_list: "Shopping List",
                    analytics: "Analytics"
                },
                status: "Status",
                "status.online": "Online",
                "status.offline": "Offline",
                search: {
                    placeholder: "Search products (e.g. milk, bread)"
                },
                stats: {
                    products: "Products",
                    products_desc: "In database",
                    savings: "Savings",
                    savings_desc: "Monthly",
                    stores: "Stores",
                    stores_desc: "Active",
                    alerts: "Alerts",
                    alerts_desc: "Active"
                },
                ai: {
                    recommendations: "AI Recommendations"
                },
                recent: {
                    products: "Recent Products"
                },
                analytics: {
                    title: "Analytics & Reports",
                    price_trends: "Price Trends",
                    savings_breakdown: "Savings Breakdown",
                    monthly_savings: "Monthly savings",
                    price_alerts: "Price Alerts"
                },
                shopping: {
                    title: "Shopping List",
                    create_new: "Create new list",
                    optimize_route: "Optimize route",
                    optimized_route: "Optimized Route",
                    your_lists: "Your lists",
                    total: "Total",
                    items: "items"
                }
            }
        };

        // Current language
        let currentLanguage = localStorage.getItem('smartshop_language') || 'tr';

        // Language functions
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('languageDropdown');
            dropdown.classList.toggle('show');
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function closeDropdown(e) {
                if (!e.target.closest('.language-selector')) {
                    dropdown.classList.remove('show');
                    document.removeEventListener('click', closeDropdown);
                }
            });
        }

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('smartshop_language', lang);
            
            // Update UI
            updateLanguageDisplay();
            updateAllTexts();
            
            // Close dropdown
            document.getElementById('languageDropdown').classList.remove('show');
            
            const messages = {
                'tr': 'ðŸ‡¹ðŸ‡· Dil TÃ¼rkÃ§e olarak deÄŸiÅŸtirildi',
                'pl': 'ðŸ‡µðŸ‡± JÄ™zyk zmieniony na Polski',
                'en': 'ðŸ‡¬ðŸ‡§ Language changed to English'
            };
            
            showNotification(messages[lang] || messages['tr'], 'success');
        }

        function updateLanguageDisplay() {
            const flagElement = document.getElementById('currentFlag');
            const langElement = document.getElementById('currentLang');
            
            if (currentLanguage === 'tr') {
                flagElement.textContent = 'ðŸ‡¹ðŸ‡·';
                langElement.textContent = 'TR';
            } else if (currentLanguage === 'pl') {
                flagElement.textContent = 'ðŸ‡µðŸ‡±';
                langElement.textContent = 'PL';
            } else {
                flagElement.textContent = 'ðŸ‡¬ðŸ‡§';
                langElement.textContent = 'EN';
            }
        }

        function updateAllTexts() {
            const currentTranslations = translations[currentLanguage];
            
            // Update all elements with data-text attribute
            document.querySelectorAll('[data-text]').forEach(element => {
                const key = element.getAttribute('data-text');
                const translation = getTranslation(key, currentTranslations);
                
                if (translation) {
                    element.textContent = translation;
                }
            });
            
            // Update placeholders
            document.querySelectorAll('[data-placeholder]').forEach(element => {
                const key = element.getAttribute('data-placeholder');
                const translation = getTranslation(key, currentTranslations);
                
                if (translation) {
                    element.placeholder = translation;
                }
            });
            
            // Update sections that need dynamic translation
            updateDynamicSections();
        }

        function getTranslation(key, translations) {
            const keys = key.split('.');
            let result = translations;
            
            for (const k of keys) {
                if (result && result[k]) {
                    result = result[k];
                } else {
                    return null;
                }
            }
            
            return result;
        }

        function updateDynamicSections() {
            // Update products section
            const productsSection = document.getElementById('products-section');
            if (productsSection && !productsSection.classList.contains('hidden')) {
                updateProductsSection();
            }
            
            // Update shopping list section
            const shoppingSection = document.getElementById('shopping-list-section');
            if (shoppingSection && !shoppingSection.classList.contains('hidden')) {
                updateShoppingListSection();
            }
            
            // Update analytics section
            const analyticsSection = document.getElementById('analytics-section');
            if (analyticsSection && !analyticsSection.classList.contains('hidden')) {
                updateAnalyticsSection();
            }
        }

        function updateProductsSection() {
            const t = translations[currentLanguage].products;
            
            // Update filter options
            const categoryFilter = document.getElementById('categoryFilter');
            if (categoryFilter && categoryFilter.options.length > 0) {
                categoryFilter.options[0].text = t.all_categories;
            }
            
            const sortFilter = document.getElementById('sortFilter');
            if (sortFilter && sortFilter.options.length > 0) {
                sortFilter.options[0].text = t.sort_name;
                sortFilter.options[1].text = t.sort_price;
                sortFilter.options[2].text = t.sort_savings;
            }
        }

        function updateShoppingListSection() {
            // This will be called when shopping list section is shown
            // Re-render the content with new language
        }

        function updateAnalyticsSection() {
            // This will be called when analytics section is shown
            // Re-render the content with new language
        }

        // Translated notification function
        function showLocalizedNotification(key, type = 'info') {
            const translation = getTranslation(`notifications.${key}`, translations[currentLanguage]);
            const message = translation || key;
            showNotification(message, type);
        }

        // Initialize language on page load
        function initializeLanguage() {
            updateLanguageDisplay();
            updateAllTexts();
        }

        // ============= END MULTILINGUAL SYSTEM =============

        // ============= LOCATION-BASED STORE FINDER ============= 
        let nearbyStores = [];
        let map;
        let currentLocationMarker;
        let storeMarkers = [];
        
        // Initialize map
        function initializeMap() {
            map = L.map('map').setView([41.0082, 28.9784], 13); // Istanbul coordinates
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(map);
            
            // Add map click event
            map.on('click', function(e) {
                const lat = e.latlng.lat;
                const lng = e.latlng.lng;
                updateLocationFromCoords(lat, lng);
            });
        }
        
        // Get current location
        async function getCurrentLocation() {
            if (navigator.geolocation) {
                const gettingMsg = getTranslation('location.getting_location', translations[currentLanguage]) || 'Konum alÄ±nÄ±yor...';
                showNotification('ðŸŒ ' + gettingMsg, 'info');
                
                navigator.geolocation.getCurrentPosition(
                    async function(position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        // Update map view
                        map.setView([lat, lng], 15);
                        
                        // Add current location marker
                        if (currentLocationMarker) {
                            map.removeLayer(currentLocationMarker);
                        }
                        
                        const currentLocText = getTranslation('location.current_location_marker', translations[currentLanguage]) || 'Mevcut Konumunuz';
                        currentLocationMarker = L.marker([lat, lng])
                            .addTo(map)
                            .bindPopup('ðŸ“ ' + currentLocText)
                            .openPopup();
                        
                        // Reverse geocoding to get address
                        try {
                            const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=${currentLanguage}`);
                            const data = await response.json();
                            
                            if (data.display_name) {
                                document.getElementById('locationInput').value = data.display_name;
                                const successMsg = getTranslation('location.location_success', translations[currentLanguage]) || 'Konum baÅŸarÄ±yla alÄ±ndÄ±!';
                                showNotification('âœ… ' + successMsg, 'success');
                                
                                // Automatically find nearby stores
                                setTimeout(() => {
                                    findNearbyStores();
                                }, 1000);
                            }
                        } catch (error) {
                            console.error('Reverse geocoding error:', error);
                            const errorMsg = getTranslation('location.address_error', translations[currentLanguage]) || 'Adres bilgisi alÄ±namadÄ±';
                            showNotification('âš ï¸ ' + errorMsg, 'warning');
                        }
                    },
                    function(error) {
                        console.error('Geolocation error:', error);
                        const deniedMsg = getTranslation('location.location_denied', translations[currentLanguage]) || 'Konum izni reddedildi';
                        showNotification('âŒ ' + deniedMsg, 'error');
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            } else {
                const noGeoMsg = getTranslation('location.no_geolocation', translations[currentLanguage]) || 'TarayÄ±cÄ±nÄ±z konum hizmetini desteklemiyor';
                showNotification('âŒ ' + noGeoMsg, 'error');
            }
        }
        
        // Update location from coordinates
        async function updateLocationFromCoords(lat, lng) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=tr`);
                const data = await response.json();
                
                if (data.display_name) {
                    document.getElementById('locationInput').value = data.display_name;
                    
                    // Add marker
                    if (currentLocationMarker) {
                        map.removeLayer(currentLocationMarker);
                    }
                    currentLocationMarker = L.marker([lat, lng])
                        .addTo(map)
                        .bindPopup('ðŸ“ SeÃ§ilen Konum');
                }
            } catch (error) {
                console.error('Reverse geocoding error:', error);
            }
        }
        
        async function findNearbyStores() {
            const location = document.getElementById('locationInput').value.trim();
            if (!location) {
                showNotification('LÃ¼tfen bir konum girin veya haritadan seÃ§in', 'warning');
                return;
            }

            const resultsDiv = document.getElementById('storeResults');
            resultsDiv.innerHTML = '<div class="text-center py-8"><div class="loading-spinner mx-auto"></div><p class="mt-4 theme-text-secondary">YakÄ±ndaki marketler aranÄ±yor...</p></div>';
            resultsDiv.classList.remove('hidden');

            try {
                // Clear existing store markers
                storeMarkers.forEach(marker => map.removeLayer(marker));
                storeMarkers = [];
                
                // Geocode the location first
                let searchCoords = null;
                if (currentLocationMarker) {
                    const markerPos = currentLocationMarker.getLatLng();
                    searchCoords = [markerPos.lat, markerPos.lng];
                } else {
                    try {
                        const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}&limit=1&accept-language=tr`);
                        const data = await response.json();
                        if (data.length > 0) {
                            searchCoords = [parseFloat(data[0].lat), parseFloat(data[0].lon)];
                            map.setView(searchCoords, 14);
                        }
                    } catch (error) {
                        console.error('Geocoding error:', error);
                    }
                }
                
                // Simulate API call to find nearby stores
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                nearbyStores = [
                    {
                        name: 'Lidl',
                        address: 'AtatÃ¼rk Cad. No:15, KadÄ±kÃ¶y',
                        distance: '0.8 km',
                        openUntil: '22:00',
                        type: 'supermarket',
                        promotions: 3,
                        rating: 4.5,
                        coords: searchCoords ? [searchCoords[0] + 0.005, searchCoords[1] + 0.003] : [41.0182, 28.9834]
                    },
                    {
                        name: 'BÄ°M',
                        address: 'Moda Cad. No:42, KadÄ±kÃ¶y',
                        distance: '1.2 km',
                        openUntil: '23:00',
                        type: 'discount',
                        promotions: 5,
                        rating: 4.2,
                        coords: searchCoords ? [searchCoords[0] - 0.003, searchCoords[1] + 0.007] : [41.0052, 28.9884]
                    },
                    {
                        name: 'Migros',
                        address: 'BaÄŸdat Cad. No:128, KadÄ±kÃ¶y',
                        distance: '1.5 km',
                        openUntil: '24:00',
                        type: 'supermarket',
                        promotions: 7,
                        rating: 4.6,
                        coords: searchCoords ? [searchCoords[0] + 0.008, searchCoords[1] - 0.004] : [41.0162, 28.9744]
                    }
                ];

                displayStoreResults();
                addStoreMarkersToMap();
                showNotification(`${nearbyStores.length} market bulundu!`, 'success');
            } catch (error) {
                resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Marketler aranÄ±rken bir hata oluÅŸtu.</p>';
                showNotification('Marketler aranÄ±rken hata oluÅŸtu', 'error');
            }
        }
        
        // Add store markers to map
        function addStoreMarkersToMap() {
            nearbyStores.forEach(store => {
                const storeIcon = L.divIcon({
                    html: `<div class="bg-blue-500 w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold">${store.name.charAt(0)}</div>`,
                    className: 'custom-marker',
                    iconSize: [32, 32],
                    iconAnchor: [16, 16]
                });
                
                const marker = L.marker(store.coords, { icon: storeIcon })
                    .addTo(map)
                    .bindPopup(`
                        <div class="p-2">
                            <h4 class="font-bold">${store.name}</h4>
                            <p class="text-sm text-gray-600">${store.address}</p>
                            <p class="text-sm"><strong>${store.distance}</strong> â€¢ ${store.openUntil}'e kadar aÃ§Ä±k</p>
                            <p class="text-sm">â­ ${store.rating} â€¢ ${store.promotions} kampanya</p>
                        </div>
                    `);
                
                storeMarkers.push(marker);
            });
        }

        // ============= PROMOTIONAL FLYERS SYSTEM ============= 
        let currentFlyers = [];
        
        function initializeFlyers() {
            currentFlyers = [
                {
                    store: 'lidl',
                    title: 'HaftalÄ±k FÄ±rsatlar',
                    validUntil: '2024-01-15',
                    discount: '50%',
                    products: [
                        { name: 'Organik Elma', price: '4.99 TL/kg', originalPrice: '9.99 TL/kg' },
                        { name: 'Tam BuÄŸday Ekmek', price: '2.50 TL', originalPrice: '4.99 TL' },
                        { name: 'SÃ¼t 1L', price: '3.99 TL', originalPrice: '6.99 TL' }
                    ],
                    image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200" fill="%230050aa"><text x="50%" y="50%" font-size="20" fill="white" text-anchor="middle" dy=".3em">LIDL</text></svg>'
                },
                {
                    store: 'bim',
                    title: 'Ã‡arÅŸamba Ã‡Ä±lgÄ±nlÄ±ÄŸÄ±',
                    validUntil: '2024-01-12',
                    discount: '40%',
                    products: [
                        { name: 'Domates', price: '2.99 TL/kg', originalPrice: '4.99 TL/kg' },
                        { name: 'Makarna', price: '1.99 TL', originalPrice: '3.99 TL' },
                        { name: 'ZeytinyaÄŸÄ± 1L', price: '24.99 TL', originalPrice: '39.99 TL' }
                    ],
                    image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200" fill="%23e31e24"><text x="50%" y="50%" font-size="20" fill="white" text-anchor="middle" dy=".3em">BÄ°M</text></svg>'
                },
                {
                    store: 'migros',
                    title: 'Haftasonu Ä°ndirimi',
                    validUntil: '2024-01-14',
                    discount: '30%',
                    products: [
                        { name: 'Tavuk But', price: '12.99 TL/kg', originalPrice: '18.99 TL/kg' },
                        { name: 'Peynir 500g', price: '19.99 TL', originalPrice: '29.99 TL' },
                        { name: 'Ã‡ay 1kg', price: '29.99 TL', originalPrice: '49.99 TL' }
                    ],
                    image: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200" fill="%23ff6900"><text x="50%" y="50%" font-size="20" fill="white" text-anchor="middle" dy=".3em">MÄ°GROS</text></svg>'
                }
            ];
            
            displayFlyers('all');
        }

        function filterFlyers(storeType) {
            // Update active filter button
            document.querySelectorAll('.flyer-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            displayFlyers(storeType);
        }

        function displayFlyers(storeType) {
            const flyersGrid = document.getElementById('flyersGrid');
            const filtered = storeType === 'all' ? currentFlyers : currentFlyers.filter(f => f.store === storeType);
            
            flyersGrid.innerHTML = filtered.map(flyer => `
                <div class="theme-bg-card rounded-xl overflow-hidden card-premium flyer-card" data-store="${flyer.store}">
                    <div class="relative">
                        <img src="${flyer.image}" alt="${flyer.store} kampanya" class="w-full h-48 object-cover">
                        <div class="absolute top-4 right-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold">
                            %${flyer.discount} Ä°NDÄ°RÄ°M
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold theme-text-primary">${flyer.title}</h3>
                            <span class="text-sm theme-text-muted">${flyer.validUntil}'e kadar</span>
                        </div>
                        
                        <div class="space-y-3 mb-6">
                            ${flyer.products.map(product => `
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all cursor-pointer" onclick="addToCartFromFlyer('${product.name}', '${product.price}')">
                                    <div>
                                        <p class="font-medium theme-text-primary">${product.name}</p>
                                        <div class="flex items-center gap-2">
                                            <span class="text-green-600 font-bold">${product.price}</span>
                                            <span class="text-gray-500 line-through text-sm">${product.originalPrice}</span>
                                        </div>
                                    </div>
                                    <button class="p-2 gradient-primary text-white rounded-lg hover:opacity-90 transition-all">
                                        <i class="lucide-plus w-4 h-4"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        
                        <button onclick="viewFullFlyer('${flyer.store}')" class="w-full py-3 border-2 border-blue-500 text-blue-500 rounded-lg hover:bg-blue-500 hover:text-white transition-all font-semibold">
                            <i class="lucide-eye w-4 h-4 mr-2"></i>
                            TÃ¼m KampanyalarÄ± GÃ¶r
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function addToCartFromFlyer(productName, price) {
            // Add animation effect
            const button = event.target.closest('button');
            button.innerHTML = '<i class="lucide-check w-4 h-4"></i>';
            button.classList.add('bg-green-500');
            
            setTimeout(() => {
                button.innerHTML = '<i class="lucide-plus w-4 h-4"></i>';
                button.classList.remove('bg-green-500');
            }, 1500);
            
            showNotification(`${productName} sepete eklendi! (${price})`, 'success');
        }

        function viewFullFlyer(store) {
            showNotification(`${store.toUpperCase()} kampanyalarÄ± gÃ¶rÃ¼ntÃ¼leniyor...`, 'info');
            // Here you would typically open a modal or navigate to full flyer view
        }

        // ============= PRICE COMPARISON SYSTEM ============= 
        let priceData = {};
        
        function initializePriceData() {
            priceData = {
                'bread': [
                    { store: 'Lidl', price: 2.50, originalPrice: 3.99, discount: 37 },
                    { store: 'BÄ°M', price: 2.99, originalPrice: 3.49, discount: 14 },
                    { store: 'Migros', price: 3.25, originalPrice: 4.99, discount: 35 },
                    { store: 'Åžok', price: 2.75, originalPrice: 3.99, discount: 31 }
                ],
                'milk': [
                    { store: 'Lidl', price: 8.99, originalPrice: 10.99, discount: 18 },
                    { store: 'BÄ°M', price: 7.99, originalPrice: 9.99, discount: 20 },
                    { store: 'Migros', price: 9.49, originalPrice: 11.99, discount: 21 },
                    { store: 'Åžok', price: 8.49, originalPrice: 10.49, discount: 19 }
                ],
                'eggs': [
                    { store: 'Lidl', price: 12.99, originalPrice: 15.99, discount: 19 },
                    { store: 'BÄ°M', price: 11.99, originalPrice: 14.99, discount: 20 },
                    { store: 'Migros', price: 13.49, originalPrice: 16.99, discount: 21 },
                    { store: 'Åžok', price: 12.49, originalPrice: 15.49, discount: 19 }
                ],
                'rice': [
                    { store: 'Lidl', price: 24.99, originalPrice: 29.99, discount: 17 },
                    { store: 'BÄ°M', price: 22.99, originalPrice: 27.99, discount: 18 },
                    { store: 'Migros', price: 26.49, originalPrice: 32.99, discount: 20 },
                    { store: 'Åžok', price: 23.99, originalPrice: 28.99, discount: 17 }
                ]
            };
        }

        async function searchPrices() {
            const searchTerm = document.getElementById('priceSearchInput').value.trim().toLowerCase();
            if (!searchTerm) {
                showNotification('LÃ¼tfen bir Ã¼rÃ¼n adÄ± girin', 'warning');
                return;
            }

            const resultsDiv = document.getElementById('priceResults');
            resultsDiv.innerHTML = '<div class="text-center py-8"><div class="loading-spinner mx-auto"></div><p class="mt-4 theme-text-secondary">Fiyatlar karÅŸÄ±laÅŸtÄ±rÄ±lÄ±yor...</p></div>';
            resultsDiv.classList.remove('hidden');

            try {
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // Find matching products
                const matches = Object.keys(priceData).filter(product => 
                    product.includes(searchTerm) || 
                    (searchTerm.includes('ekmek') && product === 'bread') ||
                    (searchTerm.includes('sÃ¼t') && product === 'milk') ||
                    (searchTerm.includes('yumurta') && product === 'eggs') ||
                    (searchTerm.includes('pirinÃ§') && product === 'rice')
                );

                if (matches.length > 0) {
                    displayPriceComparison(matches[0]);
                } else {
                    resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Bu Ã¼rÃ¼n iÃ§in fiyat bilgisi bulunamadÄ±.</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Fiyatlar aranÄ±rken bir hata oluÅŸtu.</p>';
                showNotification('Fiyat aramasÄ±nda hata oluÅŸtu', 'error');
            }
        }

        function comparePrices(product) {
            const resultsDiv = document.getElementById('priceResults');
            resultsDiv.classList.remove('hidden');
            displayPriceComparison(product);
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function displayPriceComparison(product) {
            const resultsDiv = document.getElementById('priceResults');
            const prices = priceData[product];
            
            if (!prices) {
                resultsDiv.innerHTML = '<p class="text-center theme-text-secondary py-8">Bu Ã¼rÃ¼n iÃ§in fiyat bilgisi bulunamadÄ±.</p>';
                return;
            }

            // Sort by price (ascending)
            const sortedPrices = [...prices].sort((a, b) => a.price - b.price);
            const bestDeal = sortedPrices[0];

            const productNames = {
                'bread': 'Ekmek',
                'milk': 'SÃ¼t (1L)',
                'eggs': 'Yumurta (30\'lu)',
                'rice': 'PirinÃ§ (1kg)'
            };

            resultsDiv.innerHTML = `
                <div class="mb-6">
                    <h3 class="text-2xl font-bold theme-text-primary mb-2">${productNames[product]} Fiyat KarÅŸÄ±laÅŸtÄ±rmasÄ±</h3>
                    <p class="theme-text-secondary">En uygun fiyat: <span class="text-green-600 font-bold">${bestDeal.store}</span> - ${bestDeal.price} TL</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    ${sortedPrices.map((item, index) => `
                        <div class="theme-bg-card rounded-xl p-6 card-premium ${index === 0 ? 'ring-2 ring-green-500' : ''}" onclick="selectPriceOption('${item.store}', '${item.price}', '${productNames[product]}')">
                            ${index === 0 ? '<div class="absolute -top-2 -right-2 bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">EN UYGUN</div>' : ''}
                            
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center">
                                    <div class="w-12 h-12 ${getStoreColor(item.store)} rounded-full flex items-center justify-center mr-4">
                                        <i class="lucide-store w-6 h-6 text-white"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg theme-text-primary">${item.store}</h4>
                                        <p class="theme-text-muted text-sm">Market</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-green-600">${item.price} TL</div>
                                    <div class="text-sm text-gray-500 line-through">${item.originalPrice} TL</div>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between mb-4">
                                <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-semibold">
                                    %${item.discount} Ä°ndirim
                                </span>
                                <span class="text-sm theme-text-muted">
                                    ${(item.originalPrice - item.price).toFixed(2)} TL tasarruf
                                </span>
                            </div>
                            
                            <button class="w-full py-2 gradient-primary text-white rounded-lg hover:opacity-90 transition-all">
                                <i class="lucide-shopping-cart w-4 h-4 mr-2"></i>
                                Sepete Ekle
                            </button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getStoreColor(store) {
            const colors = {
                'Lidl': 'bg-blue-600',
                'BÄ°M': 'bg-red-600', 
                'Migros': 'bg-orange-600',
                'Åžok': 'bg-purple-600'
            };
            return colors[store] || 'bg-gray-600';
        }

        function selectPriceOption(store, price, product) {
            showNotification(`${product} - ${store} (${price} TL) sepete eklendi!`, 'success');
        }

        // Initialize language on page load
        function initializeTranslations() {
            updateLanguageDisplay();
            updateAllTexts();
        }

        // Product Category System
        function showProductCategory(categoryId) {
            const productSection = document.getElementById('shops-section');
            
            // Define product categories with subcategories and example products
            const productCategories = {
                'groceries': {
                    title: 'ðŸ¥¦ Groceries',
                    icon: 'lucide-apple',
                    subcategories: {
                        'vegetables': {
                            title: 'ðŸ¥¬ Vegetables',
                            products: [
                                { name: 'Organic Carrots', price: '3.99 PLN', store: 'LIDL', image: 'ðŸ¥•', discount: '15%' },
                                { name: 'Fresh Spinach', price: '2.49 PLN', store: 'Biedronka', image: 'ðŸ¥¬', discount: '10%' },
                                { name: 'Roma Tomatoes', price: '4.99 PLN', store: 'Carrefour', image: 'ðŸ…', discount: '20%' }
                            ]
                        },
                        'fruits': {
                            title: 'ðŸŽ Fruits',
                            products: [
                                { name: 'Fresh Bananas', price: '2.99 PLN', store: 'LIDL', image: 'ðŸŒ', discount: '25%' },
                                { name: 'Red Apples', price: '3.49 PLN', store: 'Biedronka', image: 'ðŸŽ', discount: '18%' },
                                { name: 'Strawberries', price: '7.99 PLN', store: 'Carrefour', image: 'ðŸ“', discount: '30%' }
                            ]
                        },
                        'organic': {
                            title: 'ðŸŒ± Organic Products',
                            products: [
                                { name: 'Organic Eggs', price: '8.99 PLN', store: 'LIDL', image: 'ðŸ¥š', discount: '10%' },
                                { name: 'Organic Milk', price: '6.49 PLN', store: 'Biedronka', image: 'ðŸ¥›', discount: '15%' },
                                { name: 'Organic Bread', price: '4.99 PLN', store: 'Carrefour', image: 'ðŸž', discount: '12%' }
                            ]
                        },
                        'snacks': {
                            title: 'ðŸ¥œ Nuts & Snacks',
                            products: [
                                { name: 'Mixed Nuts', price: '12.99 PLN', store: 'LIDL', image: 'ðŸ¥œ', discount: '20%' },
                                { name: 'Potato Chips', price: '3.99 PLN', store: 'Biedronka', image: 'ðŸŸ', discount: '25%' },
                                { name: 'Chocolate Bar', price: '2.99 PLN', store: 'Carrefour', image: 'ðŸ«', discount: '15%' }
                            ]
                        }
                    }
                },
                'alcohol': {
                    title: 'ðŸ¾ Alcohol',
                    icon: 'lucide-wine',
                    subcategories: {
                        'beer': {
                            title: 'ðŸº Beer',
                            products: [
                                { name: 'Lager Beer 6-pack', price: '15.99 PLN', store: 'LIDL', image: 'ðŸº', discount: '10%' },
                                { name: 'Craft Beer', price: '8.99 PLN', store: 'Biedronka', image: 'ðŸº', discount: '15%' }
                            ]
                        },
                        'wine': {
                            title: 'ðŸ· Wine',
                            products: [
                                { name: 'Red Wine', price: '29.99 PLN', store: 'LIDL', image: 'ðŸ·', discount: '20%' },
                                { name: 'White Wine', price: '24.99 PLN', store: 'Carrefour', image: 'ðŸ·', discount: '15%' }
                            ]
                        }
                    }
                },
                'beverages': {
                    title: 'ðŸ¥¤ Beverages',
                    icon: 'lucide-coffee',
                    subcategories: {
                        'soft-drinks': {
                            title: 'ðŸ¥¤ Soft Drinks',
                            products: [
                                { name: 'Cola 2L', price: '5.99 PLN', store: 'LIDL', image: 'ðŸ¥¤', discount: '25%' },
                                { name: 'Orange Juice 1L', price: '4.99 PLN', store: 'Biedronka', image: 'ðŸ§ƒ', discount: '20%' }
                            ]
                        }
                    }
                },
                'electronics': {
                    title: 'ðŸ“± Electronics',
                    icon: 'lucide-smartphone',
                    subcategories: {
                        'smartphones': {
                            title: 'ðŸ“± Smartphones',
                            products: [
                                { name: 'iPhone 15', price: '3999 PLN', store: 'MediaMarkt', image: 'ðŸ“±', discount: '5%' },
                                { name: 'Samsung Galaxy S24', price: '3499 PLN', store: 'RTV EURO AGD', image: 'ðŸ“±', discount: '8%' }
                            ]
                        },
                        'computers': {
                            title: 'ðŸ’» Computers',
                            products: [
                                { name: 'MacBook Air M2', price: '4999 PLN', store: 'MediaMarkt', image: 'ðŸ’»', discount: '10%' },
                                { name: 'Dell XPS 13', price: '3999 PLN', store: 'RTV EURO AGD', image: 'ðŸ’»', discount: '15%' }
                            ]
                        }
                    }
                },
                'home-garden': {
                    title: 'ðŸ›€ Home & Garden',
                    icon: 'lucide-home',
                    subcategories: {
                        'bathroom': {
                            title: 'ðŸ› Bathroom Essentials',
                            products: [
                                { name: 'Shampoo 400ml', price: '12.99 PLN', store: 'Rossmann', image: 'ðŸ§´', discount: '20%' },
                                { name: 'Toilet Paper 12pk', price: '15.99 PLN', store: 'DM', image: 'ðŸ§»', discount: '25%' }
                            ]
                        },
                        'kitchen': {
                            title: 'ðŸ³ Kitchenware',
                            products: [
                                { name: 'Non-stick Pan', price: '39.99 PLN', store: 'IKEA', image: 'ðŸ³', discount: '30%' },
                                { name: 'Glass Bowl Set', price: '24.99 PLN', store: 'Jysk', image: 'ðŸ¥£', discount: '20%' }
                            ]
                        }
                    }
                },
                'cleaning': {
                    title: 'ðŸ§´ Cleaning Products',
                    icon: 'lucide-spray-can',
                    subcategories: {
                        'laundry': {
                            title: 'ðŸ‘• Laundry',
                            products: [
                                { name: 'Washing Powder 5kg', price: '29.99 PLN', store: 'LIDL', image: 'ðŸ§º', discount: '15%' },
                                { name: 'Fabric Softener 3L', price: '19.99 PLN', store: 'Biedronka', image: 'ðŸ§´', discount: '20%' }
                            ]
                        }
                    }
                },
                'children': {
                    title: 'ðŸ¼ Children',
                    icon: 'lucide-baby',
                    subcategories: {
                        'toys': {
                            title: 'ðŸ§¸ Toys',
                            products: [
                                { name: 'LEGO Set', price: '99.99 PLN', store: 'Smyk', image: 'ðŸ§¸', discount: '25%' },
                                { name: 'Plush Toy', price: '29.99 PLN', store: 'Smyk', image: 'ðŸ§¸', discount: '30%' }
                            ]
                        }
                    }
                },
                'fashion': {
                    title: 'ðŸ‘— Fashion',
                    icon: 'lucide-shirt',
                    subcategories: {
                        'mens': {
                            title: 'ðŸ‘” Men\'s',
                            products: [
                                { name: 'T-Shirt Pack', price: '24.99 PLN', store: 'C&A', image: 'ðŸ‘•', discount: '25%' },
                                { name: 'Jeans', price: '49.99 PLN', store: 'Takko Fashion', image: 'ðŸ‘–', discount: '30%' }
                            ]
                        },
                        'womens': {
                            title: 'ðŸ‘— Women\'s',
                            products: [
                                { name: 'Dress', price: '39.99 PLN', store: 'C&A', image: 'ðŸ‘—', discount: '35%' },
                                { name: 'Blouse', price: '29.99 PLN', store: 'Takko Fashion', image: 'ðŸ‘š', discount: '25%' }
                            ]
                        }
                    }
                },
                'cosmetics': {
                    title: 'ðŸ› Cosmetics & Health',
                    icon: 'lucide-sparkles',
                    subcategories: {
                        'skincare': {
                            title: 'âœ¨ Skincare',
                            products: [
                                { name: 'Face Cream 50ml', price: '19.99 PLN', store: 'Rossmann', image: 'ðŸ§´', discount: '25%' },
                                { name: 'Sunscreen SPF50', price: '14.99 PLN', store: 'DM', image: 'ðŸ§´', discount: '20%' }
                            ]
                        }
                    }
                },
                'pets': {
                    title: 'ðŸ¾ Pets',
                    icon: 'lucide-heart',
                    subcategories: {
                        'dog-food': {
                            title: 'ðŸ• Dog Food',
                            products: [
                                { name: 'Dry Dog Food 15kg', price: '89.99 PLN', store: 'Kakadu', image: 'ðŸ•', discount: '15%' },
                                { name: 'Wet Dog Food 12x400g', price: '49.99 PLN', store: 'MAXI ZOO', image: 'ðŸ•', discount: '20%' }
                            ]
                        }
                    }
                },
                'automotive': {
                    title: 'ðŸš— Automotive',
                    icon: 'lucide-car',
                    subcategories: {
                        'tires': {
                            title: 'ðŸ›ž Tires',
                            products: [
                                { name: 'Summer Tires 205/55R16', price: '299.99 PLN', store: 'Castorama', image: 'ðŸ›ž', discount: '15%' },
                                { name: 'Winter Tires 195/65R15', price: '349.99 PLN', store: 'Leroy Merlin', image: 'ðŸ›ž', discount: '20%' }
                            ]
                        }
                    }
                },
                'sports': {
                    title: 'ðŸš´ Sports & Outdoors',
                    icon: 'lucide-dumbbell',
                    subcategories: {
                        'bikes': {
                            title: 'ðŸš² Bikes',
                            products: [
                                { name: 'Mountain Bike', price: '999.99 PLN', store: 'Decathlon', image: 'ðŸš²', discount: '10%' },
                                { name: 'City Bike', price: '799.99 PLN', store: '4F', image: 'ðŸš²', discount: '15%' }
                            ]
                        }
                    }
                },
                'entertainment': {
                    title: 'ðŸŽ² Entertainment',
                    icon: 'lucide-gamepad-2',
                    subcategories: {
                        'books': {
                            title: 'ðŸ“š Books',
                            products: [
                                { name: 'Best Seller Novel', price: '24.99 PLN', store: 'Empik', image: 'ðŸ“–', discount: '20%' },
                                { name: 'Cookbook', price: '19.99 PLN', store: 'taniaksiazka.pl', image: 'ðŸ‘¨â€ðŸ³', discount: '25%' }
                            ]
                        }
                    }
                }
            };

            const category = productCategories[categoryId];
            if (!category) return;

            productSection.innerHTML = `
                <div class="mb-6">
                    <button onclick="goBack()" class="flex items-center text-blue-600 hover:text-blue-800 transition-colors mb-4 px-4 py-2 rounded-lg border border-blue-200 hover:bg-blue-50">
                        <i class="lucide-arrow-left w-5 h-5 mr-2"></i>
                        <span data-text="back">Back to Categories</span>
                    </button>
                    <h3 class="text-3xl font-bold theme-text-primary mb-2 flex items-center">
                        <i class="${category.icon} w-8 h-8 mr-3 theme-text-accent"></i>
                        ${category.title}
                    </h3>
                    <p class="theme-text-secondary mb-6">Select a subcategory to view products</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${Object.entries(category.subcategories).map(([subId, subcategory]) => `
                        <div class="theme-bg-card rounded-xl p-6 card-premium group relative hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showProducts('${categoryId}', '${subId}')">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full flex items-center justify-center mr-4 group-hover:animate-bounce">
                                    <span class="text-2xl">${subcategory.title.split(' ')[0]}</span>
                                </div>
                                <h4 class="text-lg font-bold theme-text-primary">${subcategory.title}</h4>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="theme-text-secondary">${subcategory.products.length} products available</span>
                                <i class="lucide-arrow-right w-5 h-5 theme-text-accent group-hover:transform group-hover:translate-x-1 transition-transform"></i>
                            </div>
                            <!-- Hover Tooltip -->
                            <div class="absolute -top-2 left-1/2 transform -translate-x-1/2 -translate-y-full opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
                                <div class="bg-gray-900 text-white px-4 py-2 rounded-lg text-sm whitespace-nowrap shadow-lg">
                                    Click to view ${subcategory.products.length} ${subcategory.title.toLowerCase()}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            updateLanguage();
        }

        function showProducts(categoryId, subcategoryId) {
            const productSection = document.getElementById('shops-section');
            
            const productCategories = {
                'groceries': {
                    title: 'ðŸ¥¦ Groceries',
                    subcategories: {
                        'vegetables': {
                            title: 'ðŸ¥¬ Vegetables',
                            products: [
                                { name: 'Organic Carrots', price: '3.99 PLN', store: 'LIDL', image: 'ðŸ¥•', discount: '15%' },
                                { name: 'Fresh Spinach', price: '2.49 PLN', store: 'Biedronka', image: 'ðŸ¥¬', discount: '10%' },
                                { name: 'Roma Tomatoes', price: '4.99 PLN', store: 'Carrefour', image: 'ðŸ…', discount: '20%' }
                            ]
                        },
                        'fruits': {
                            title: 'ðŸŽ Fruits',
                            products: [
                                { name: 'Fresh Bananas', price: '2.99 PLN', store: 'LIDL', image: 'ðŸŒ', discount: '25%' },
                                { name: 'Red Apples', price: '3.49 PLN', store: 'Biedronka', image: 'ðŸŽ', discount: '18%' },
                                { name: 'Strawberries', price: '7.99 PLN', store: 'Carrefour', image: 'ðŸ“', discount: '30%' }
                            ]
                        },
                        'organic': {
                            title: 'ðŸŒ± Organic Products',
                            products: [
                                { name: 'Organic Eggs', price: '8.99 PLN', store: 'LIDL', image: 'ðŸ¥š', discount: '10%' },
                                { name: 'Organic Milk', price: '6.49 PLN', store: 'Biedronka', image: 'ðŸ¥›', discount: '15%' },
                                { name: 'Organic Bread', price: '4.99 PLN', store: 'Carrefour', image: 'ðŸž', discount: '12%' }
                            ]
                        },
                        'snacks': {
                            title: 'ðŸ¥œ Nuts & Snacks',
                            products: [
                                { name: 'Mixed Nuts', price: '12.99 PLN', store: 'LIDL', image: 'ðŸ¥œ', discount: '20%' },
                                { name: 'Potato Chips', price: '3.99 PLN', store: 'Biedronka', image: 'ðŸŸ', discount: '25%' },
                                { name: 'Chocolate Bar', price: '2.99 PLN', store: 'Carrefour', image: 'ðŸ«', discount: '15%' }
                            ]
                        }
                    }
                },
                'alcohol': {
                    title: 'ðŸ¾ Alcohol',
                    icon: 'lucide-wine',
                    subcategories: {
                        'beer': {
                            title: 'ðŸº Beer',
                            products: [
                                { name: 'Lager Beer 6-pack', price: '15.99 PLN', store: 'LIDL', image: 'ðŸº', discount: '10%' },
                                { name: 'Craft Beer', price: '8.99 PLN', store: 'Biedronka', image: 'ðŸº', discount: '15%' }
                            ]
                        },
                        'wine': {
                            title: 'ðŸ· Wine',
                            products: [
                                { name: 'Red Wine', price: '29.99 PLN', store: 'LIDL', image: 'ðŸ·', discount: '20%' },
                                { name: 'White Wine', price: '24.99 PLN', store: 'Carrefour', image: 'ðŸ·', discount: '15%' }
                            ]
                        }
                    }
                },
                'beverages': {
                    title: 'ðŸ¥¤ Beverages',
                    icon: 'lucide-coffee',
                    subcategories: {
                        'soft-drinks': {
                            title: 'ðŸ¥¤ Soft Drinks',
                            products: [
                                { name: 'Cola 2L', price: '5.99 PLN', store: 'LIDL', image: 'ðŸ¥¤', discount: '25%' },
                                { name: 'Orange Juice 1L', price: '4.99 PLN', store: 'Biedronka', image: 'ðŸ§ƒ', discount: '20%' }
                            ]
                        }
                    }
                },
                'electronics': {
                    title: 'ðŸ“± Electronics',
                    icon: 'lucide-smartphone',
                    subcategories: {
                        'smartphones': {
                            title: 'ðŸ“± Smartphones',
                            products: [
                                { name: 'iPhone 15', price: '3999 PLN', store: 'MediaMarkt', image: 'ðŸ“±', discount: '5%' },
                                { name: 'Samsung Galaxy S24', price: '3499 PLN', store: 'RTV EURO AGD', image: 'ðŸ“±', discount: '8%' }
                            ]
                        },
                        'computers': {
                            title: 'ðŸ’» Computers',
                            products: [
                                { name: 'MacBook Air M2', price: '4999 PLN', store: 'MediaMarkt', image: 'ðŸ’»', discount: '10%' },
                                { name: 'Dell XPS 13', price: '3999 PLN', store: 'RTV EURO AGD', image: 'ðŸ’»', discount: '15%' }
                            ]
                        }
                    }
                },
                'home-garden': {
                    title: 'ðŸ›€ Home & Garden',
                    icon: 'lucide-home',
                    subcategories: {
                        'bathroom': {
                            title: 'ðŸ› Bathroom Essentials',
                            products: [
                                { name: 'Shampoo 400ml', price: '12.99 PLN', store: 'Rossmann', image: 'ðŸ§´', discount: '20%' },
                                { name: 'Toilet Paper 12pk', price: '15.99 PLN', store: 'DM', image: 'ðŸ§»', discount: '25%' }
                            ]
                        },
                        'kitchen': {
                            title: 'ðŸ³ Kitchenware',
                            products: [
                                { name: 'Non-stick Pan', price: '39.99 PLN', store: 'IKEA', image: 'ðŸ³', discount: '30%' },
                                { name: 'Glass Bowl Set', price: '24.99 PLN', store: 'Jysk', image: 'ðŸ¥£', discount: '20%' }
                            ]
                        }
                    }
                },
                'cleaning': {
                    title: 'ðŸ§´ Cleaning Products',
                    icon: 'lucide-spray-can',
                    subcategories: {
                        'laundry': {
                            title: 'ðŸ‘• Laundry',
                            products: [
                                { name: 'Washing Powder 5kg', price: '29.99 PLN', store: 'LIDL', image: 'ðŸ§º', discount: '15%' },
                                { name: 'Fabric Softener 3L', price: '19.99 PLN', store: 'Biedronka', image: 'ðŸ§´', discount: '20%' }
                            ]
                        }
                    }
                },
                'children': {
                    title: 'ðŸ¼ Children',
                    icon: 'lucide-baby',
                    subcategories: {
                        'toys': {
                            title: 'ðŸ§¸ Toys',
                            products: [
                                { name: 'LEGO Set', price: '99.99 PLN', store: 'Smyk', image: 'ðŸ§¸', discount: '25%' },
                                { name: 'Plush Toy', price: '29.99 PLN', store: 'Smyk', image: 'ðŸ§¸', discount: '30%' }
                            ]
                        }
                    }
                },
                'fashion': {
                    title: 'ðŸ‘— Fashion',
                    icon: 'lucide-shirt',
                    subcategories: {
                        'mens': {
                            title: 'ðŸ‘” Men\'s',
                            products: [
                                { name: 'T-Shirt Pack', price: '24.99 PLN', store: 'C&A', image: 'ðŸ‘•', discount: '25%' },
                                { name: 'Jeans', price: '49.99 PLN', store: 'Takko Fashion', image: 'ðŸ‘–', discount: '30%' }
                            ]
                        },
                        'womens': {
                            title: 'ðŸ‘— Women\'s',
                            products: [
                                { name: 'Dress', price: '39.99 PLN', store: 'C&A', image: 'ðŸ‘—', discount: '35%' },
                                { name: 'Blouse', price: '29.99 PLN', store: 'Takko Fashion', image: 'ðŸ‘š', discount: '25%' }
                            ]
                        }
                    }
                },
                'cosmetics': {
                    title: 'ðŸ› Cosmetics & Health',
                    icon: 'lucide-sparkles',
                    subcategories: {
                        'skincare': {
                            title: 'âœ¨ Skincare',
                            products: [
                                { name: 'Face Cream 50ml', price: '19.99 PLN', store: 'LIDL', image: 'ðŸ§´', discount: '25%' },
                                { name: 'Sunscreen SPF50', price: '14.99 PLN', store: 'BÄ°M', image: 'ðŸ§´', discount: '20%' },
                                { name: 'Face Mask Set', price: '12.99 PLN', store: 'Migros', image: 'ðŸ§´', discount: '30%' }
                            ]
                        },
                        'bath': {
                            title: 'ðŸ› Bath & Body Care',
                            products: [
                                { name: 'Body Wash 400ml', price: '8.99 PLN', store: 'LIDL', image: 'ðŸ§´', discount: '20%' },
                                { name: 'Body Lotion', price: '12.99 PLN', store: 'BÄ°M', image: 'ðŸ§´', discount: '25%' },
                                { name: 'Bath Bombs Set', price: '16.99 PLN', store: 'Migros', image: 'ðŸ›', discount: '15%' }
                            ]
                        }
                    }
                },
                'pets': {
                    title: 'ðŸ¶ Pets',
                    icon: 'lucide-heart',
                    subcategories: {
                        'dog-food': {
                            title: 'ðŸ• Dog Food',
                            products: [
                                { name: 'Dry Dog Food 5kg', price: '49.99 PLN', store: 'LIDL', image: 'ðŸ•', discount: '20%' },
                                { name: 'Wet Dog Food 12pk', price: '24.99 PLN', store: 'BÄ°M', image: 'ðŸ¥«', discount: '25%' },
                                { name: 'Dog Treats', price: '8.99 PLN', store: 'Migros', image: 'ðŸ¦´', discount: '15%' }
                            ]
                        },
                        'cat-food': {
                            title: 'ðŸ± Cat Food',
                            products: [
                                { name: 'Dry Cat Food 3kg', price: '39.99 PLN', store: 'LIDL', image: 'ðŸ±', discount: '30%' },
                                { name: 'Wet Cat Food 12pk', price: '19.99 PLN', store: 'BÄ°M', image: 'ðŸ¥«', discount: '20%' },
                                { name: 'Cat Litter 10L', price: '14.99 PLN', store: 'Migros', image: 'ðŸª£', discount: '25%' }
                            ]
                        }
                    }
                },
                'automotive': {
                    title: 'ðŸš— Automotive',
                    icon: 'lucide-car',
                    subcategories: {
                        'tires': {
                            title: 'ðŸ›ž Tires',
                            products: [
                                { name: 'Summer Tires 205/55R16', price: '299.99 PLN', store: 'AutoParts', image: 'ðŸ›ž', discount: '15%' },
                                { name: 'Winter Tires 195/65R15', price: '349.99 PLN', store: 'TireShop', image: 'ðŸ›ž', discount: '20%' },
                                { name: 'All Season Tires', price: '279.99 PLN', store: 'AutoParts', image: 'ðŸ›ž', discount: '10%' }
                            ]
                        },
                        'accessories': {
                            title: 'ðŸ”§ Car Accessories',
                            products: [
                                { name: 'Car Phone Holder', price: '19.99 PLN', store: 'LIDL', image: 'ðŸ“±', discount: '25%' },
                                { name: 'Car Charger', price: '12.99 PLN', store: 'BÄ°M', image: 'ðŸ”Œ', discount: '20%' },
                                { name: 'Air Freshener', price: '4.99 PLN', store: 'Migros', image: 'ðŸŒ¸', discount: '30%' }
                            ]
                        }
                    }
                },
                'sports': {
                    title: 'ðŸš´ Sports & Outdoors',
                    icon: 'lucide-dumbbell',
                    subcategories: {
                        'fitness': {
                            title: 'ðŸ’ª Fitness',
                            products: [
                                { name: 'Yoga Mat', price: '29.99 PLN', store: 'SportShop', image: 'ðŸ§˜', discount: '25%' },
                                { name: 'Dumbbells 5kg', price: '49.99 PLN', store: 'FitnessStore', image: 'ðŸ‹ï¸', discount: '20%' },
                                { name: 'Resistance Bands', price: '19.99 PLN', store: 'SportShop', image: 'ðŸƒ', discount: '30%' }
                            ]
                        },
                        'outdoor': {
                            title: 'ðŸ•ï¸ Outdoor',
                            products: [
                                { name: 'Camping Tent 2p', price: '149.99 PLN', store: 'OutdoorGear', image: 'â›º', discount: '15%' },
                                { name: 'Sleeping Bag', price: '79.99 PLN', store: 'CampingStore', image: 'ðŸ›Œ', discount: '20%' },
                                { name: 'Hiking Backpack', price: '99.99 PLN', store: 'OutdoorGear', image: 'ðŸŽ’', discount: '25%' }
                            ]
                        }
                    }
                },
                'entertainment': {
                    title: 'ðŸŽ² Entertainment',
                    icon: 'lucide-gamepad-2',
                    subcategories: {
                        'books': {
                            title: 'ðŸ“š Books',
                            products: [
                                { name: 'Best Seller Novel', price: '24.99 PLN', store: 'BookStore', image: 'ðŸ“–', discount: '20%' },
                                { name: 'Cookbook', price: '19.99 PLN', store: 'LIDL', image: 'ðŸ‘¨â€ðŸ³', discount: '25%' },
                                { name: 'Self-Help Book', price: '29.99 PLN', store: 'BookStore', image: 'ðŸ“š', discount: '15%' }
                            ]
                        },
                        'games': {
                            title: 'ðŸŽ® Video Games',
                            products: [
                                { name: 'PlayStation Game', price: '199.99 PLN', store: 'GameStore', image: 'ðŸŽ®', discount: '30%' },
                                { name: 'Nintendo Switch Game', price: '149.99 PLN', store: 'GameStore', image: 'ðŸŽ®', discount: '25%' },
                                { name: 'PC Game', price: '99.99 PLN', store: 'DigitalStore', image: 'ðŸ’»', discount: '40%' }
                            ]
                        }
                    }
                }
            };

            const category = productCategories[categoryId];
            const subcategory = category?.subcategories[subcategoryId];
            if (!subcategory) return;

            productSection.innerHTML = `
                <div class="mb-6">
                    <button onclick="goBack()" class="flex items-center text-blue-600 hover:text-blue-800 transition-colors mb-4 px-4 py-2 rounded-lg border border-blue-200 hover:bg-blue-50">
                        <i class="lucide-arrow-left w-5 h-5 mr-2"></i>
                        <span data-text="back">Back to ${category.title}</span>
                    </button>
                    <h3 class="text-3xl font-bold theme-text-primary mb-2 flex items-center">
                        <span class="text-4xl mr-3">${subcategory.title.split(' ')[0]}</span>
                        ${subcategory.title}
                    </h3>
                    <p class="theme-text-secondary mb-6">${subcategory.products.length} products available with great discounts!</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    ${subcategory.products.map(product => `
                        <div class="theme-bg-card rounded-xl p-6 card-premium group hover:transform hover:scale-105 transition-all duration-300 cursor-pointer relative">
                            <div class="absolute top-4 right-4 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                                -${product.discount}
                            </div>
                            <div class="text-center mb-4">
                                <div class="w-20 h-20 mx-auto mb-3 bg-gray-100 rounded-lg overflow-hidden">
                                    <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300">
                                </div>
                                <h4 class="text-lg font-bold theme-text-primary mb-2">${product.name}</h4>
                                <div class="flex items-center justify-center space-x-2 mb-2">
                                    <span class="text-2xl font-bold theme-text-accent">${product.price}</span>
                                    <span class="text-sm text-gray-500 line-through">${product.originalPrice}</span>
                                </div>
                                <div class="flex items-center justify-center space-x-2 mb-3">
                                    <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">${product.store}</span>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="addToCart('${product.name}', '${product.price}', '${product.store}')" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-medium">
                                    <i class="lucide-shopping-cart w-4 h-4 mr-2 inline"></i>
                                    Add to Cart
                                </button>
                                <button class="p-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors">
                                    <i class="lucide-heart w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            updateLanguage();
        }

        // Add to Cart functionality
        function addToCart(productName, price, store) {
            // Add product to shopping list
            const product = {
                id: Date.now().toString(),
                name: productName,
                price: price,
                store: store,
                quantity: 1
            };
            
            // Add to global shopping list
            if (!window.shoppingList) {
                window.shoppingList = [];
            }
            window.shoppingList.push(product);
            
            // Show success notification
            showNotification(`${productName} sepete eklendi! (${price} - ${store})`, 'success');
            
            // Update shopping list display if visible
            renderShoppingList();
        }

        // Back navigation function
        function goBack() {
            // Navigate back to previous view
            showShops();
        }

        // Generate multi-store pricing for products
        function generateMultiStorePricing(product) {
            const stores = ['LIDL', 'BÄ°M', 'Migros', 'Åžok', 'CarrefourSA'];
            const basePrice = parseFloat(product.price.replace(/[^\d.]/g, ''));
            
            return stores.map(store => {
                const variation = (Math.random() - 0.5) * 0.3; // Â±15% variation
                const price = Math.max(basePrice * (1 + variation), basePrice * 0.7);
                return {
                    store: store,
                    price: price.toFixed(2) + ' PLN',
                    isLowest: store === 'LIDL' // LIDL genellikle en ucuz
                };
            }).sort((a, b) => parseFloat(a.price) - parseFloat(b.price));
        }

        // ============= SHOPS SECTION FUNCTIONS =============
        
        // Store data with categories and products
        const storeData = {
            'grocery': {
                name: 'ðŸ›ï¸ Grocery Stores',
                icon: 'lucide-shopping-cart',
                categories: [
                    { id: 'biedronka', name: 'Biedronka', icon: 'ðŸ›’' },
                    { id: 'lidl', name: 'Lidl', icon: 'ðŸ›’' },
                    { id: 'netto', name: 'Netto', icon: 'ðŸ›’' },
                    { id: 'carrefour', name: 'Carrefour', icon: 'ðŸ›’' },
                    { id: 'kaufland', name: 'Kaufland', icon: 'ðŸ›’' }
                ]
            },
            'home-garden': {
                name: 'ðŸ¡ Home & Garden',
                icon: 'lucide-home',
                categories: [
                    { id: 'kik', name: 'KiK', icon: 'ðŸ ' },
                    { id: 'pepco', name: 'Pepco', icon: 'ðŸ ' },
                    { id: 'home-you', name: 'home&you', icon: 'ðŸ ' },
                    { id: 'action', name: 'Action', icon: 'ðŸ ' }
                ]
            },
            'drugstores': {
                name: 'ðŸ’Š Drugstores',
                icon: 'lucide-pill',
                categories: [
                    { id: 'rossmann', name: 'Rossmann', icon: 'ðŸ’Š' },
                    { id: 'hebe', name: 'Hebe', icon: 'ðŸ’Š' },
                    { id: 'dm', name: 'DM', icon: 'ðŸ’Š' }
                ]
            },
            'children': {
                name: 'ðŸ§¸ Children',
                icon: 'lucide-baby',
                categories: [
                    { id: 'smyk', name: 'Smyk', icon: 'ðŸ§¸' }
                ]
            },
            'furniture': {
                name: 'ðŸ›ï¸ Furniture',
                icon: 'lucide-sofa',
                categories: [
                    { id: 'jysk', name: 'Jysk', icon: 'ðŸ›ï¸' },
                    { id: 'abra', name: 'Abra', icon: 'ðŸ›ï¸' },
                    { id: 'agata', name: 'Agata Meble', icon: 'ðŸ›ï¸' },
                    { id: 'brw', name: 'Black Red White', icon: 'ðŸ›ï¸' },
                    { id: 'ikea', name: 'IKEA', icon: 'ðŸ›ï¸' }
                ]
            },
            'construction': {
                name: 'ðŸ”¨ Construction',
                icon: 'lucide-hammer',
                categories: [
                    { id: 'castorama', name: 'Castorama', icon: 'ðŸ”¨' },
                    { id: 'leroy', name: 'Leroy Merlin', icon: 'ðŸ”¨' },
                    { id: 'obi', name: 'OBI', icon: 'ðŸ”¨' },
                    { id: 'bricomarche', name: 'Bricomarche', icon: 'ðŸ”¨' }
                ]
            },
            'electronics': {
                name: 'ðŸ“º Electronics & Appliances',
                icon: 'lucide-tv',
                categories: [
                    { id: 'rtv', name: 'RTV EURO AGD', icon: 'ðŸ“º' },
                    { id: 'media-expert', name: 'Media Expert', icon: 'ðŸ“º' },
                    { id: 'media-markt', name: 'Media Markt', icon: 'ðŸ“º' }
                ]
            },
            'fashion': {
                name: 'ðŸ‘— Fashion & Jewellery',
                icon: 'lucide-shirt',
                categories: [
                    { id: 'takko', name: 'Takko Fashion', icon: 'ðŸ‘—' },
                    { id: 'ca', name: 'C&A', icon: 'ðŸ‘—' }
                ]
            },
            'sports': {
                name: 'ðŸ… Sport',
                icon: 'lucide-trophy',
                categories: [
                    { id: '4f', name: '4F', icon: 'ðŸ…' },
                    { id: 'adidas', name: 'Adidas', icon: 'ðŸ…' },
                    { id: 'decathlon', name: 'Decathlon', icon: 'ðŸ…' }
                ]
            },
            'shoes': {
                name: 'ðŸ‘Ÿ Shoes',
                icon: 'lucide-shoe',
                categories: [
                    { id: 'ccc', name: 'CCC', icon: 'ðŸ‘Ÿ' },
                    { id: 'deichmann', name: 'Deichmann', icon: 'ðŸ‘Ÿ' },
                    { id: 'eobuwie', name: 'eobuwie.pl', icon: 'ðŸ‘Ÿ' },
                    { id: 'new-balance', name: 'New Balance', icon: 'ðŸ‘Ÿ' }
                ]
            },
            'pets': {
                name: 'ðŸ¾ Pet Supplies',
                icon: 'lucide-paw-print',
                categories: [
                    { id: 'kakadu', name: 'Kakadu', icon: 'ðŸ¾' },
                    { id: 'maxi-zoo', name: 'MAXI ZOO', icon: 'ðŸ¾' }
                ]
            },
            'culture': {
                name: 'ðŸ“š Culture & Entertainment',
                icon: 'lucide-book',
                categories: [
                    { id: 'empik', name: 'Empik', icon: 'ðŸ“š' },
                    { id: 'taniaksiazka', name: 'taniaksiazka.pl', icon: 'ðŸ“š' }
                ]
            }
        };

        // Product categories with subcategories
        const productCategories = {
            'groceries': {
                title: 'ðŸ¥¦ Groceries',
                icon: 'lucide-apple',
                subcategories: {
                    'vegetables': { title: 'ðŸ¥¬ Vegetables' },
                    'fruits': { title: 'ðŸŽ Fruits' },
                    'organic': { title: 'ðŸŒ± Organic Products' },
                    'snacks': { title: 'ðŸ¥œ Nuts & Snacks' }
                }
            },
            'alcohol': {
                title: 'ðŸ¾ Alcohol',
                icon: 'lucide-wine',
                subcategories: {
                    'beer': { title: 'ðŸº Beer' },
                    'wine': { title: 'ðŸ· Wine' },
                    'liquor': { title: 'ðŸ¥ƒ Liquor' },
                    'whisky': { title: 'ðŸ¥ƒ Whisky' },
                    'cider': { title: 'ðŸŽ Cider' },
                    'gin': { title: 'ðŸ¸ Gin' },
                    'rum': { title: 'ðŸ¥ƒ Rum' }
                }
            },
            'beverages': {
                title: 'ðŸ¥¤ Beverages',
                icon: 'lucide-coffee',
                subcategories: {
                    'soft-drinks': { title: 'ðŸ¥¤ Soft Drinks' },
                    'juices': { title: 'ðŸ§ƒ Juices' }
                }
            },
            'electronics': {
                title: 'ðŸ“± Electronics',
                icon: 'lucide-smartphone',
                subcategories: {
                    'appliances': { title: 'ðŸ  Appliances' },
                    'tvs': { title: 'ðŸ“º TVs' },
                    'computers': { title: 'ðŸ’» Computers' },
                    'smartphones': { title: 'ðŸ“± Smartphones' },
                    'tablets': { title: 'ðŸ“± Tablets' },
                    'smartwatches': { title: 'âŒš Smartwatches' }
                }
            },
            'home-garden': {
                title: 'ðŸ›€ Home & Garden',
                icon: 'lucide-home',
                subcategories: {
                    'bathroom': { title: 'ðŸ› Bathroom Essentials' },
                    'kitchenware': { title: 'ðŸ³ Kitchenware' }
                }
            },
            'cleaning': {
                title: 'ðŸ§´ Cleaning Products',
                icon: 'lucide-spray-can',
                subcategories: {
                    'laundry': { title: 'ðŸ‘• Laundry' },
                    'dishwashing': { title: 'ðŸ½ï¸ Dishwashing' },
                    'general': { title: 'ðŸ§¹ General Cleaning' }
                }
            },
            'children': {
                title: 'ðŸ¼ Children',
                icon: 'lucide-baby',
                subcategories: {
                    'toys': { title: 'ðŸ§¸ Toys' },
                    'diapers': { title: 'ðŸ§· Diapers' },
                    'school': { title: 'ðŸ“š School Supplies' }
                }
            },
            'fashion': {
                title: 'ðŸ‘— Fashion',
                icon: 'lucide-shirt',
                subcategories: {
                    'mens': { title: 'ðŸ‘” Men\'s' },
                    'womens': { title: 'ðŸ‘— Women\'s' },
                    'children': { title: 'ðŸ‘¶ Children\'s' },
                    'shoes': { title: 'ðŸ‘Ÿ Shoes' }
                }
            },
            'cosmetics': {
                title: 'ðŸ› Cosmetics & Health',
                icon: 'lucide-sparkles',
                subcategories: {
                    'soap': { title: 'ðŸ§¼ Soap' },
                    'bath': { title: 'ðŸ› Bath & Body Care' },
                    'skincare': { title: 'âœ¨ Skincare' }
                }
            },
            'pets': {
                title: 'ðŸ¶ Pets',
                icon: 'lucide-heart',
                subcategories: {
                    'dog': { title: 'ðŸ• Dog Food' },
                    'cat': { title: 'ðŸ± Cat Food' }
                }
            },
            'automotive': {
                title: 'ðŸš— Automotive',
                icon: 'lucide-car',
                subcategories: {
                    'tires': { title: 'ðŸ›ž Tires' },
                    'accessories': { title: 'ðŸ”§ Car Accessories' }
                }
            },
            'sports': {
                title: 'ðŸš´ Sports & Outdoors',
                icon: 'lucide-dumbbell',
                subcategories: {
                    'scooters': { title: 'ðŸ›´ Scooters' },
                    'bikes': { title: 'ðŸš² Bikes' },
                    'pools': { title: 'ðŸŠ Pools' },
                    'grills': { title: 'ðŸ”¥ Grills' },
                    'luggage': { title: 'ðŸ§³ Luggage & Backpacks' }
                }
            },
            'entertainment': {
                title: 'ðŸŽ² Entertainment',
                icon: 'lucide-gamepad-2',
                subcategories: {
                    'books': { title: 'ðŸ“š Books' },
                    'movies': { title: 'ðŸŽ¬ Movies' },
                    'games': { title: 'ðŸŽ® Video Games' }
                }
            }
        };

        function showStoreDetails(storeId) {
            const store = storeData[storeId];
            if (!store) return;

            // Hide main stores grid
            document.getElementById('storesGrid').style.display = 'none';
            
            // Show back button
            document.getElementById('shopBackButton').classList.remove('hidden');
            
            // Show store details view
            const storeDetailsView = document.getElementById('storeDetailsView');
            storeDetailsView.classList.remove('hidden');

            // Populate store header
            document.getElementById('storeHeader').innerHTML = `
                <div class="theme-bg-card rounded-xl p-8 card-premium">
                    <div class="flex items-center mb-6">
                        <div class="w-20 h-20 ${store.color} rounded-full flex items-center justify-center mr-6">
                            ${store.logo.startsWith('http') ? 
                                `<img src="${store.logo}" alt="${store.name}" class="w-full h-full object-contain bg-white p-2 rounded-full">` :
                                `<span class="text-white font-bold text-lg">${store.logo}</span>`
                            }
                        </div>
                        <div>
                            <h2 class="text-3xl font-bold theme-text-primary mb-2">${store.name}</h2>
                            <p class="theme-text-secondary text-lg mb-2">${store.description}</p>
                            <div class="flex items-center space-x-4">
                                <span class="px-4 py-2 bg-green-100 text-green-800 rounded-full font-semibold">${store.totalProducts} Ã¼rÃ¼n</span>
                                <span class="px-4 py-2 bg-red-100 text-red-800 rounded-full font-semibold">${store.discount} indirim</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Populate categories
            document.getElementById('storeCategoriesGrid').innerHTML = store.categories.map(category => `
                <div class="theme-bg-card rounded-xl p-6 card-premium group hover:transform hover:scale-105 transition-all duration-300 cursor-pointer" onclick="showStoreCategory('${storeId}', '${category.id}')">
                    <div class="flex items-center mb-4">
                        <div class="text-3xl mr-4 group-hover:animate-bounce">${category.icon}</div>
                        <div>
                            <h4 class="text-xl font-bold theme-text-primary">${category.name}</h4>
                            <p class="theme-text-muted">${category.products.length} Ã¼rÃ¼n mevcut</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="text-sm theme-text-accent font-semibold">GÃ¶rÃ¼ntÃ¼le â†’</span>
                    </div>
                </div>
            `).join('');

            // Show all products initially
            showStoreProducts(storeId);
        }

        function showStoreCategory(storeId, categoryId) {
            const store = storeData[storeId];
            const category = store.categories.find(cat => cat.id === categoryId);
            if (!category) return;

            // Show specific category products
            document.getElementById('storeProductsGrid').innerHTML = `
                <div class="col-span-full mb-6">
                    <h3 class="text-2xl font-bold theme-text-primary mb-2 flex items-center">
                        <span class="text-3xl mr-3">${category.icon}</span>
                        ${category.name}
                    </h3>
                    <p class="theme-text-secondary">${category.products.length} Ã¼rÃ¼n bulundu</p>
                </div>
                ${category.products.map(product => createProductCard(product, store.name)).join('')}
            `;
        }

        function showStoreProducts(storeId) {
            const store = storeData[storeId];
            const allProducts = store.categories.flatMap(category => 
                category.products.map(product => ({...product, category: category.name}))
            );

            document.getElementById('storeProductsGrid').innerHTML = `
                <div class="col-span-full mb-6">
                    <h3 class="text-2xl font-bold theme-text-primary mb-2">TÃ¼m ÃœrÃ¼nler</h3>
                    <p class="theme-text-secondary">${allProducts.length} Ã¼rÃ¼n bulundu</p>
                </div>
                ${allProducts.map(product => createProductCard(product, store.name)).join('')}
            `;
        }

        function createProductCard(product, storeName) {
            const discount = Math.round(((parseFloat(product.originalPrice) - parseFloat(product.price)) / parseFloat(product.originalPrice)) * 100);
            return `
                <div class="theme-bg-card rounded-xl p-6 card-premium group hover:transform hover:scale-105 transition-all duration-300 relative">
                    <div class="absolute top-4 right-4 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold">
                        -%${discount}
                    </div>
                    <div class="text-center mb-4">
                        <div class="w-20 h-20 mx-auto mb-3 bg-gray-100 rounded-lg overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300">
                        </div>
                        <h4 class="text-lg font-bold theme-text-primary mb-2">${product.name}</h4>
                        <div class="flex items-center justify-center space-x-2 mb-2">
                            <span class="text-2xl font-bold theme-text-accent">${product.price}</span>
                            <span class="text-sm text-gray-500 line-through">${product.originalPrice}</span>
                        </div>
                        <div class="flex items-center justify-center space-x-2 mb-3">
                            <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">${storeName}</span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="addToCart('${product.name}', '${product.price}', '${product.store}')" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-medium">
                            <i class="lucide-shopping-cart w-4 h-4 mr-2 inline"></i>
                            Add to Cart
                        </button>
                        <button class="p-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors">
                            <i class="lucide-heart w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `;
        }

        function goBackToStores() {
            // Hide store details view
            document.getElementById('storeDetailsView').classList.add('hidden');
            
            // Hide back button
            document.getElementById('shopBackButton').classList.add('hidden');
            
            // Show main stores grid
            document.getElementById('storesGrid').style.display = 'grid';
        }
    </script>
</body>
</html> 